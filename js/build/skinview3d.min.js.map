{"version":3,"file":"skinview3d.min.js","sources":["../src/model.js","../src/animation.js","../src/utils.js","../src/viewer.js","../src/orbit_controls.js"],"sourcesContent":["import * as THREE from \"three\";\n\nfunction toFaceVertices(x1, y1, x2, y2, w, h) {\n\treturn [\n\t\tnew THREE.Vector2(x1 / w, 1.0 - y2 / h),\n\t\tnew THREE.Vector2(x2 / w, 1.0 - y2 / h),\n\t\tnew THREE.Vector2(x2 / w, 1.0 - y1 / h),\n\t\tnew THREE.Vector2(x1 / w, 1.0 - y1 / h)\n\t];\n}\n\nfunction toSkinVertices(x1, y1, x2, y2) {\n\treturn toFaceVertices(x1, y1, x2, y2, 64.0, 64.0);\n}\n\nfunction toCapeVertices(x1, y1, x2, y2) {\n\treturn toFaceVertices(x1, y1, x2, y2, 64.0, 32.0);\n}\n\nfunction setVertices(box, top, bottom, left, front, right, back) {\n\tbox.faceVertexUvs[0] = [];\n\tbox.faceVertexUvs[0][0] = [right[3], right[0], right[2]];\n\tbox.faceVertexUvs[0][1] = [right[0], right[1], right[2]];\n\tbox.faceVertexUvs[0][2] = [left[3], left[0], left[2]];\n\tbox.faceVertexUvs[0][3] = [left[0], left[1], left[2]];\n\tbox.faceVertexUvs[0][4] = [top[3], top[0], top[2]];\n\tbox.faceVertexUvs[0][5] = [top[0], top[1], top[2]];\n\tbox.faceVertexUvs[0][6] = [bottom[0], bottom[3], bottom[1]];\n\tbox.faceVertexUvs[0][7] = [bottom[3], bottom[2], bottom[1]];\n\tbox.faceVertexUvs[0][8] = [front[3], front[0], front[2]];\n\tbox.faceVertexUvs[0][9] = [front[0], front[1], front[2]];\n\tbox.faceVertexUvs[0][10] = [back[3], back[0], back[2]];\n\tbox.faceVertexUvs[0][11] = [back[0], back[1], back[2]];\n}\n\nconst esp = 0.002;\n\nclass SkinObject extends THREE.Group {\n\tconstructor(layer1Material, layer2Material) {\n\t\tsuper();\n\n\t\tthis.modelListeners = []; // called when model(slim property) is changed\n\n\t\t// Head\n\t\tthis.head = new THREE.Group();\n\n\t\tlet headBox = new THREE.BoxGeometry(8, 8, 8, 0, 0, 0);\n\t\tsetVertices(headBox,\n\t\t\ttoSkinVertices(8, 0, 16, 8),\n\t\t\ttoSkinVertices(16, 0, 24, 8),\n\t\t\ttoSkinVertices(0, 8, 8, 16),\n\t\t\ttoSkinVertices(8, 8, 16, 16),\n\t\t\ttoSkinVertices(16, 8, 24, 16),\n\t\t\ttoSkinVertices(24, 8, 32, 16)\n\t\t);\n\t\tlet headMesh = new THREE.Mesh(headBox, layer1Material);\n\t\tthis.head.add(headMesh);\n\n\t\tlet head2Box = new THREE.BoxGeometry(9, 9, 9, 0, 0, 0);\n\t\tsetVertices(head2Box,\n\t\t\ttoSkinVertices(40, 0, 48, 8),\n\t\t\ttoSkinVertices(48, 0, 56, 8),\n\t\t\ttoSkinVertices(32, 8, 40, 16),\n\t\t\ttoSkinVertices(40, 8, 48, 16),\n\t\t\ttoSkinVertices(48, 8, 56, 16),\n\t\t\ttoSkinVertices(56, 8, 64, 16)\n\t\t);\n\t\tlet head2Mesh = new THREE.Mesh(head2Box, layer2Material);\n\t\thead2Mesh.renderOrder = -1;\n\t\tthis.head.add(head2Mesh);\n\n\t\tthis.add(this.head);\n\n\n\t\t// Body\n\t\tthis.body = new THREE.Group();\n\n\t\tlet bodyBox = new THREE.BoxGeometry(8, 12, 4, 0, 0, 0);\n\t\tsetVertices(bodyBox,\n\t\t\ttoSkinVertices(20, 16, 28, 20),\n\t\t\ttoSkinVertices(28, 16, 36, 20),\n\t\t\ttoSkinVertices(16, 20, 20, 32),\n\t\t\ttoSkinVertices(20, 20, 28, 32),\n\t\t\ttoSkinVertices(28, 20, 32, 32),\n\t\t\ttoSkinVertices(32, 20, 40, 32)\n\t\t);\n\t\tlet bodyMesh = new THREE.Mesh(bodyBox, layer1Material);\n\t\tthis.body.add(bodyMesh);\n\n\t\tlet body2Box = new THREE.BoxGeometry(9, 13.5, 4.5, 0, 0, 0);\n\t\tsetVertices(body2Box,\n\t\t\ttoSkinVertices(20, 32, 28, 36),\n\t\t\ttoSkinVertices(28, 32, 36, 36),\n\t\t\ttoSkinVertices(16, 36, 20, 48),\n\t\t\ttoSkinVertices(20, 36, 28, 48),\n\t\t\ttoSkinVertices(28, 36, 32, 48),\n\t\t\ttoSkinVertices(32, 36, 40, 48)\n\t\t);\n\t\tlet body2Mesh = new THREE.Mesh(body2Box, layer2Material);\n\t\tthis.body.add(body2Mesh);\n\n\t\tthis.body.position.y = -10;\n\t\tthis.add(this.body);\n\n\n\t\t// Right Arm\n\t\tthis.rightArm = new THREE.Group();\n\t\tlet rightArmPivot = new THREE.Group();\n\n\t\tlet rightArmBox = new THREE.BoxGeometry(1, 1, 1, 0, 0, 0); // w/d/h is model-related\n\t\tlet rightArmMesh = new THREE.Mesh(rightArmBox, layer1Material);\n\t\trightArmPivot.add(rightArmMesh);\n\t\tthis.modelListeners.push(() => {\n\t\t\trightArmMesh.scale.x = (this.slim ? 3 : 4) - esp;\n\t\t\trightArmMesh.scale.y = 12 - esp;\n\t\t\trightArmMesh.scale.z = 4 - esp;\n\t\t\tif (this.slim) {\n\t\t\t\tsetVertices(rightArmBox,\n\t\t\t\t\ttoSkinVertices(44, 16, 47, 20),\n\t\t\t\t\ttoSkinVertices(47, 16, 50, 20),\n\t\t\t\t\ttoSkinVertices(40, 20, 44, 32),\n\t\t\t\t\ttoSkinVertices(44, 20, 47, 32),\n\t\t\t\t\ttoSkinVertices(47, 20, 51, 32),\n\t\t\t\t\ttoSkinVertices(51, 20, 54, 32)\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tsetVertices(rightArmBox,\n\t\t\t\t\ttoSkinVertices(44, 16, 48, 20),\n\t\t\t\t\ttoSkinVertices(48, 16, 52, 20),\n\t\t\t\t\ttoSkinVertices(40, 20, 44, 32),\n\t\t\t\t\ttoSkinVertices(44, 20, 48, 32),\n\t\t\t\t\ttoSkinVertices(48, 20, 52, 32),\n\t\t\t\t\ttoSkinVertices(52, 20, 56, 32)\n\t\t\t\t);\n\t\t\t}\n\t\t\trightArmBox.uvsNeedUpdate = true;\n\t\t\trightArmBox.elementsNeedUpdate = true;\n\t\t});\n\n\t\tlet rightArm2Box = new THREE.BoxGeometry(1, 1, 1, 0, 0, 0); // w/d/h is model-related\n\t\tlet rightArm2Mesh = new THREE.Mesh(rightArm2Box, layer2Material);\n\t\trightArm2Mesh.renderOrder = 1;\n\t\trightArmPivot.add(rightArm2Mesh);\n\t\tthis.modelListeners.push(() => {\n\t\t\trightArm2Mesh.scale.x = (this.slim ? 3.375 : 4.5) - esp;\n\t\t\trightArm2Mesh.scale.y = 13.5 - esp;\n\t\t\trightArm2Mesh.scale.z = 4.5 - esp;\n\t\t\tif (this.slim) {\n\t\t\t\tsetVertices(rightArm2Box,\n\t\t\t\t\ttoSkinVertices(44, 32, 47, 36),\n\t\t\t\t\ttoSkinVertices(47, 32, 50, 36),\n\t\t\t\t\ttoSkinVertices(40, 36, 44, 48),\n\t\t\t\t\ttoSkinVertices(44, 36, 47, 48),\n\t\t\t\t\ttoSkinVertices(47, 36, 51, 48),\n\t\t\t\t\ttoSkinVertices(51, 36, 54, 48)\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tsetVertices(rightArm2Box,\n\t\t\t\t\ttoSkinVertices(44, 32, 48, 36),\n\t\t\t\t\ttoSkinVertices(48, 32, 52, 36),\n\t\t\t\t\ttoSkinVertices(40, 36, 44, 48),\n\t\t\t\t\ttoSkinVertices(44, 36, 48, 48),\n\t\t\t\t\ttoSkinVertices(48, 36, 52, 48),\n\t\t\t\t\ttoSkinVertices(52, 36, 56, 48)\n\t\t\t\t);\n\t\t\t}\n\t\t\trightArm2Box.uvsNeedUpdate = true;\n\t\t\trightArm2Box.elementsNeedUpdate = true;\n\t\t});\n\n\t\trightArmPivot.position.y = -6;\n\t\tthis.rightArm.add(rightArmPivot);\n\t\tthis.rightArm.position.y = -4;\n\t\tthis.modelListeners.push(() => {\n\t\t\tthis.rightArm.position.x = this.slim ? -5.5 : -6;\n\t\t});\n\t\tthis.add(this.rightArm);\n\n\n\t\t// Left Arm\n\t\tthis.leftArm = new THREE.Group();\n\t\tlet leftArmPivot = new THREE.Group();\n\n\t\tlet leftArmBox = new THREE.BoxGeometry(1, 1, 1, 0, 0, 0); // w/d/h is model-related\n\t\tlet leftArmMesh = new THREE.Mesh(leftArmBox, layer1Material);\n\t\tleftArmPivot.add(leftArmMesh);\n\t\tthis.modelListeners.push(() => {\n\t\t\tleftArmMesh.scale.x = (this.slim ? 3 : 4) - esp;\n\t\t\tleftArmMesh.scale.y = 12 - esp;\n\t\t\tleftArmMesh.scale.z = 4 - esp;\n\t\t\tif (this.slim) {\n\t\t\t\tsetVertices(leftArmBox,\n\t\t\t\t\ttoSkinVertices(36, 48, 39, 52),\n\t\t\t\t\ttoSkinVertices(39, 48, 42, 52),\n\t\t\t\t\ttoSkinVertices(32, 52, 36, 64),\n\t\t\t\t\ttoSkinVertices(36, 52, 39, 64),\n\t\t\t\t\ttoSkinVertices(39, 52, 43, 64),\n\t\t\t\t\ttoSkinVertices(43, 52, 46, 64)\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tsetVertices(leftArmBox,\n\t\t\t\t\ttoSkinVertices(36, 48, 40, 52),\n\t\t\t\t\ttoSkinVertices(40, 48, 44, 52),\n\t\t\t\t\ttoSkinVertices(32, 52, 36, 64),\n\t\t\t\t\ttoSkinVertices(36, 52, 40, 64),\n\t\t\t\t\ttoSkinVertices(40, 52, 44, 64),\n\t\t\t\t\ttoSkinVertices(44, 52, 48, 64)\n\t\t\t\t);\n\t\t\t}\n\t\t\tleftArmBox.uvsNeedUpdate = true;\n\t\t\tleftArmBox.elementsNeedUpdate=true;\n\t\t});\n\n\t\tlet leftArm2Box = new THREE.BoxGeometry(1, 1, 1, 0, 0, 0); // w/d/h is model-related\n\t\tlet leftArm2Mesh = new THREE.Mesh(leftArm2Box, layer2Material);\n\t\tleftArm2Mesh.renderOrder = 1;\n\t\tleftArmPivot.add(leftArm2Mesh);\n\t\tthis.modelListeners.push(() => {\n\t\t\tleftArm2Mesh.scale.x = (this.slim ? 3.375 : 4.5) - esp;\n\t\t\tleftArm2Mesh.scale.y = 13.5 - esp;\n\t\t\tleftArm2Mesh.scale.z = 4.5 - esp;\n\t\t\tif (this.slim) {\n\t\t\t\tsetVertices(leftArm2Box,\n\t\t\t\t\ttoSkinVertices(52, 48, 55, 52),\n\t\t\t\t\ttoSkinVertices(55, 48, 58, 52),\n\t\t\t\t\ttoSkinVertices(48, 52, 52, 64),\n\t\t\t\t\ttoSkinVertices(52, 52, 55, 64),\n\t\t\t\t\ttoSkinVertices(55, 52, 59, 64),\n\t\t\t\t\ttoSkinVertices(59, 52, 62, 64)\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tsetVertices(leftArm2Box,\n\t\t\t\t\ttoSkinVertices(52, 48, 56, 52),\n\t\t\t\t\ttoSkinVertices(56, 48, 60, 52),\n\t\t\t\t\ttoSkinVertices(48, 52, 52, 64),\n\t\t\t\t\ttoSkinVertices(52, 52, 56, 64),\n\t\t\t\t\ttoSkinVertices(56, 52, 60, 64),\n\t\t\t\t\ttoSkinVertices(60, 52, 64, 64)\n\t\t\t\t);\n\t\t\t}\n\t\t\tleftArm2Box.uvsNeedUpdate = true;\n\t\t\tleftArm2Box.elementsNeedUpdate = true;\n\t\t});\n\n\t\tleftArmPivot.position.y = -6;\n\t\tthis.leftArm.add(leftArmPivot);\n\t\tthis.leftArm.position.y = -4;\n\t\tthis.modelListeners.push(() => {\n\t\t\tthis.leftArm.position.x = this.slim ? 5.5 : 6;\n\t\t});\n\t\tthis.add(this.leftArm);\n\n\n\t\t// Right Leg\n\t\tthis.rightLeg = new THREE.Group();\n\t\tlet rightLegPivot = new THREE.Group();\n\n\t\tlet rightLegBox = new THREE.BoxGeometry(4 - esp, 12 - esp, 4 - esp, 0, 0, 0);\n\t\tsetVertices(rightLegBox,\n\t\t\ttoSkinVertices(4, 16, 8, 20),\n\t\t\ttoSkinVertices(8, 16, 12, 20),\n\t\t\ttoSkinVertices(0, 20, 4, 32),\n\t\t\ttoSkinVertices(4, 20, 8, 32),\n\t\t\ttoSkinVertices(8, 20, 12, 32),\n\t\t\ttoSkinVertices(12, 20, 16, 32)\n\t\t);\n\t\tlet rightLegMesh = new THREE.Mesh(rightLegBox, layer1Material);\n\t\trightLegPivot.add(rightLegMesh);\n\n\t\tlet rightLeg2Box = new THREE.BoxGeometry(4.5 - esp, 13.5 - esp, 4.5 - esp, 0, 0, 0);\n\t\tsetVertices(rightLeg2Box,\n\t\t\ttoSkinVertices(4, 32, 8, 36),\n\t\t\ttoSkinVertices(8, 32, 12, 36),\n\t\t\ttoSkinVertices(0, 36, 4, 48),\n\t\t\ttoSkinVertices(4, 36, 8, 48),\n\t\t\ttoSkinVertices(8, 36, 12, 48),\n\t\t\ttoSkinVertices(12, 36, 16, 48)\n\t\t);\n\t\tlet rightLeg2Mesh = new THREE.Mesh(rightLeg2Box, layer2Material);\n\t\trightLeg2Mesh.renderOrder = 1;\n\t\trightLegPivot.add(rightLeg2Mesh);\n\n\t\trightLegPivot.position.y = -6;\n\t\tthis.rightLeg.add(rightLegPivot);\n\t\tthis.rightLeg.position.y = -16;\n\t\tthis.rightLeg.position.x = -2;\n\t\tthis.add(this.rightLeg);\n\n\t\t// Left Leg\n\t\tthis.leftLeg = new THREE.Group();\n\t\tlet leftLegPivot = new THREE.Group();\n\n\t\tlet leftLegBox = new THREE.BoxGeometry(4 - esp, 12 - esp, 4 - esp, 0, 0, 0);\n\t\tsetVertices(leftLegBox,\n\t\t\ttoSkinVertices(20, 48, 24, 52),\n\t\t\ttoSkinVertices(24, 48, 28, 52),\n\t\t\ttoSkinVertices(16, 52, 20, 64),\n\t\t\ttoSkinVertices(20, 52, 24, 64),\n\t\t\ttoSkinVertices(24, 52, 28, 64),\n\t\t\ttoSkinVertices(28, 52, 32, 64)\n\t\t);\n\t\tlet leftLegMesh = new THREE.Mesh(leftLegBox, layer1Material);\n\t\tleftLegPivot.add(leftLegMesh);\n\n\t\tlet leftLeg2Box = new THREE.BoxGeometry(4.5 - esp, 13.5 - esp, 4.5 - esp, 0, 0, 0);\n\t\tsetVertices(leftLeg2Box,\n\t\t\ttoSkinVertices(4, 48, 8, 52),\n\t\t\ttoSkinVertices(8, 48, 12, 52),\n\t\t\ttoSkinVertices(0, 52, 4, 64),\n\t\t\ttoSkinVertices(4, 52, 8, 64),\n\t\t\ttoSkinVertices(8, 52, 12, 64),\n\t\t\ttoSkinVertices(12, 52, 16, 64)\n\t\t);\n\t\tlet leftLeg2Mesh = new THREE.Mesh(leftLeg2Box, layer2Material);\n\t\tleftLeg2Mesh.renderOrder = 1;\n\t\tleftLegPivot.add(leftLeg2Mesh);\n\n\t\tleftLegPivot.position.y = -6;\n\t\tthis.leftLeg.add(leftLegPivot);\n\t\tthis.leftLeg.position.y = -16;\n\t\tthis.leftLeg.position.x = 2;\n\t\tthis.add(this.leftLeg);\n\n\t\tthis.slim = false;\n\t}\n\n\tget slim() {\n\t\treturn this._slim;\n\t}\n\n\tset slim(value) {\n\t\tif (this._slim !== value) {\n\t\t\tthis._slim = value;\n\t\t\tthis.modelListeners.forEach(listener => listener());\n\t\t}\n\t}\n}\n\nclass CapeObject extends THREE.Group {\n\tconstructor(capeMaterial) {\n\t\tsuper();\n\n\t\t// back = outside\n\t\t// front = inside\n\t\tlet capeBox = new THREE.BoxGeometry(10, 16, 1, 0, 0, 0);\n\t\tsetVertices(capeBox,\n\t\t\ttoCapeVertices(1, 0, 11, 1),\n\t\t\ttoCapeVertices(11, 0, 21, 1),\n\t\t\ttoCapeVertices(11, 1, 12, 17),\n\t\t\ttoCapeVertices(12, 1, 22, 17),\n\t\t\ttoCapeVertices(0, 1, 1, 17),\n\t\t\ttoCapeVertices(1, 1, 11, 17)\n\t\t);\n\t\tthis.cape = new THREE.Mesh(capeBox, capeMaterial);\n\t\tthis.cape.position.y = -8;\n\t\tthis.cape.position.z = -0.5;\n\t\tthis.add(this.cape);\n\t}\n}\n\nclass PlayerObject extends THREE.Group {\n\tconstructor(layer1Material, layer2Material, capeMaterial) {\n\t\tsuper();\n\n\t\tthis.skin = new SkinObject(layer1Material, layer2Material);\n\t\tthis.skin.visible = false;\n\t\tthis.add(this.skin);\n\n\t\tthis.cape = new CapeObject(capeMaterial);\n\t\tthis.cape.position.z = -2;\n\t\tthis.cape.position.y = -4;\n\t\tthis.cape.rotation.x = 25 * Math.PI / 180;\n\t\tthis.cape.visible = false;\n\t\tthis.add(this.cape);\n\t}\n}\n\nexport { SkinObject, CapeObject, PlayerObject };\n","function invokeAnimation(animation, player, time) {\n\tif (animation instanceof CompositeAnimation) {\n\t\tanimation.play(player, time);\n\t} else if (animation instanceof Function) {\n\t\tanimation(player, time);\n\t} else {\n\t\tthrow `Not an animation: ${animation}`;\n\t}\n}\n\nclass AnimationHandle {\n\tconstructor(animation) {\n\t\tthis.animation = animation;\n\t\tthis.paused = this._paused = false;\n\t\tthis.speed = this._speed = 1.0;\n\t\tthis._lastChange = null;\n\t\tthis._lastChangeX = null;\n\t}\n\tplay(player, time) {\n\t\tif (this._lastChange === null) {\n\t\t\tthis._lastChange = time;\n\t\t\tthis._lastChangeX = 0;\n\t\t} else if (this.paused !== this._paused || this.speed !== this._speed) {\n\t\t\tlet dt = time - this._lastChange;\n\t\t\tif (this._paused === false) {\n\t\t\t\tthis._lastChangeX += dt * this._speed;\n\t\t\t}\n\t\t\tthis._paused = this.paused;\n\t\t\tthis._speed = this.speed;\n\t\t\tthis._lastChange = time;\n\t\t}\n\t\tif (this.paused === false) {\n\t\t\tlet dt = time - this._lastChange;\n\t\t\tlet x = this._lastChangeX + this.speed * dt;\n\t\t\tinvokeAnimation(this.animation, player, x);\n\t\t}\n\t}\n\treset(){\n\t\tthis._lastChange = null;\n\t}\n}\n\nclass CompositeAnimation {\n\tconstructor() {\n\t\tthis.handles = new Set();\n\t}\n\tadd(animation) {\n\t\tlet handle = new AnimationHandle(animation);\n\t\thandle.remove = () => this.handles.delete(handle);\n\t\tthis.handles.add(handle);\n\t\treturn handle;\n\t}\n\tplay(player, time) {\n\t\tthis.handles.forEach(handle => handle.play(player, time));\n\t}\n}\n\nlet WalkingAnimation = (player, time) => {\n\tlet skin = player.skin;\n\n\t// Multiply by animation's natural speed\n\ttime *= 8;\n\n\t// Leg swing\n\tskin.leftLeg.rotation.x  = Math.sin(time) * 0.5;\n\tskin.rightLeg.rotation.x = Math.sin(time + Math.PI) * 0.5;\n\n\t// Arm swing\n\tskin.leftArm.rotation.x  = Math.sin(time + Math.PI) * 0.5;\n\tskin.rightArm.rotation.x = Math.sin(time) * 0.5;\n\tlet basicArmRotationZ    = Math.PI * 0.02;\n\tskin.leftArm.rotation.z  = Math.cos(time) * 0.03 + basicArmRotationZ;\n\tskin.rightArm.rotation.z = Math.cos(time + Math.PI) * 0.03 - basicArmRotationZ;\n\n\t// Head shaking with different frequency & amplitude\n\tskin.head.rotation.y = Math.sin(time / 4) * 0.2;\n\tskin.head.rotation.x = Math.sin(time / 5) * 0.1;\n\n\t// Always add an angle for cape around the x axis\n\tlet basicCapeRotationX = Math.PI * 0.06;\n\tplayer.cape.rotation.x = Math.sin(time / 1.5) * 0.06 + basicCapeRotationX;\n};\n\nlet RunningAnimation = (player, time) => {\n\tlet skin = player.skin;\n\n\ttime *= 15;\n\n\t// Leg swing with larger amplitude\n\tskin.leftLeg.rotation.x  = Math.cos(time + Math.PI) * 1.3;\n\tskin.rightLeg.rotation.x = Math.cos(time) * 1.3;\n\n\t// Arm swing\n\tskin.leftArm.rotation.x  = Math.cos(time) * 1.5;\n\tskin.rightArm.rotation.x = Math.cos(time + Math.PI) * 1.5;\n\tlet basicArmRotationZ    = Math.PI * 0.1;\n\tskin.leftArm.rotation.z  = Math.cos(time) * 0.1 + basicArmRotationZ;\n\tskin.rightArm.rotation.z = Math.cos(time + Math.PI) * 0.1 - basicArmRotationZ;\n\n\t// Jumping\n\tplayer.position.y = Math.cos(time * 2);\n\t// Dodging when running\n\tplayer.position.x = Math.cos(time) * 0.15;\n\t// Slightly tilting when running\n\tplayer.rotation.z = Math.cos(time + Math.PI) * 0.01;\n\n\t// Apply higher swing frequency, lower amplitude,\n\t// and greater basic rotation around x axis,\n\t// to cape when running.\n\tlet basicCapeRotationX = Math.PI * 0.3;\n\tplayer.cape.rotation.x = Math.sin(time * 2) * 0.1 + basicCapeRotationX;\n\n\t// What about head shaking?\n\t// You shouldn't glance right and left when running dude :P\n};\n\nlet RotatingAnimation = (player, time) => {\n\tplayer.rotation.y = time;\n};\n\nexport {\n\tCompositeAnimation,\n\tinvokeAnimation,\n\tWalkingAnimation,\n\tRunningAnimation,\n\tRotatingAnimation\n};\n","function copyImage(context, sX, sY, w, h, dX, dY, flipHorizontal) {\n\tlet imgData = context.getImageData(sX, sY, w, h);\n\tif (flipHorizontal) {\n\t\tfor (let y = 0; y < h; y++) {\n\t\t\tfor (let x = 0; x < (w / 2); x++) {\n\t\t\t\tlet index = (x + y * w) * 4;\n\t\t\t\tlet index2 = ((w - x - 1) + y * w) * 4;\n\t\t\t\tlet pA1 = imgData.data[index];\n\t\t\t\tlet pA2 = imgData.data[index + 1];\n\t\t\t\tlet pA3 = imgData.data[index + 2];\n\t\t\t\tlet pA4 = imgData.data[index + 3];\n\n\t\t\t\tlet pB1 = imgData.data[index2];\n\t\t\t\tlet pB2 = imgData.data[index2 + 1];\n\t\t\t\tlet pB3 = imgData.data[index2 + 2];\n\t\t\t\tlet pB4 = imgData.data[index2 + 3];\n\n\t\t\t\timgData.data[index] = pB1;\n\t\t\t\timgData.data[index + 1] = pB2;\n\t\t\t\timgData.data[index + 2] = pB3;\n\t\t\t\timgData.data[index + 3] = pB4;\n\n\t\t\t\timgData.data[index2] = pA1;\n\t\t\t\timgData.data[index2 + 1] = pA2;\n\t\t\t\timgData.data[index2 + 2] = pA3;\n\t\t\t\timgData.data[index2 + 3] = pA4;\n\t\t\t}\n\t\t}\n\t}\n\tcontext.putImageData(imgData, dX, dY);\n}\n\nfunction hasTransparency(context, x0, y0, w, h) {\n\tlet imgData = context.getImageData(x0, y0, w, h);\n\tfor (let x = 0; x < w; x++) {\n\t\tfor (let y = 0; y < h; y++) {\n\t\t\tlet offset = (x + y * w) * 4;\n\t\t\tif (imgData.data[offset + 3] !== 0xff) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t}\n\treturn false;\n}\n\nfunction computeSkinScale(width) {\n\treturn width / 64.0;\n}\n\nfunction fixOpaqueSkin(context, width) {\n\t// Some ancient skins don't have transparent pixels (nor have helm).\n\t// We have to make the helm area transparent, otherwise it will be rendered as black.\n\tif (!hasTransparency(context, 0, 0, width, width / 2)) {\n\t\tlet scale = computeSkinScale(width);\n\t\tlet clearArea = (x, y, w, h) => context.clearRect(x * scale, y * scale, w * scale, h * scale);\n\t\tclearArea(40, 0, 8, 8); // Helm Top\n\t\tclearArea(48, 0, 8, 8); // Helm Bottom\n\t\tclearArea(32, 8, 8, 8); // Helm Right\n\t\tclearArea(40, 8, 8, 8); // Helm Front\n\t\tclearArea(48, 8, 8, 8); // Helm Left\n\t\tclearArea(56, 8, 8, 8); // Helm Back\n\t}\n}\n\nfunction convertSkinTo1_8(context, width) {\n\tlet scale = computeSkinScale(width);\n\tlet copySkin = (sX, sY, w, h, dX, dY, flipHorizontal) => copyImage(context, sX * scale, sY * scale, w * scale, h * scale, dX * scale, dY * scale, flipHorizontal);\n\n\tfixOpaqueSkin(context, width);\n\n\tcopySkin(4, 16, 4, 4, 20, 48, true); // Top Leg\n\tcopySkin(8, 16, 4, 4, 24, 48, true); // Bottom Leg\n\tcopySkin(0, 20, 4, 12, 24, 52, true); // Outer Leg\n\tcopySkin(4, 20, 4, 12, 20, 52, true); // Front Leg\n\tcopySkin(8, 20, 4, 12, 16, 52, true); // Inner Leg\n\tcopySkin(12, 20, 4, 12, 28, 52, true); // Back Leg\n\tcopySkin(44, 16, 4, 4, 36, 48, true); // Top Arm\n\tcopySkin(48, 16, 4, 4, 40, 48, true); // Bottom Arm\n\tcopySkin(40, 20, 4, 12, 40, 52, true); // Outer Arm\n\tcopySkin(44, 20, 4, 12, 36, 52, true); // Front Arm\n\tcopySkin(48, 20, 4, 12, 32, 52, true); // Inner Arm\n\tcopySkin(52, 20, 4, 12, 44, 52, true); // Back Arm\n}\n\nfunction loadSkinToCanvas(canvas, image) {\n\tlet isOldFormat = false;\n\tif (image.width !== image.height) {\n\t\tif (image.width === 2 * image.height) {\n\t\t\tisOldFormat = true;\n\t\t} else {\n\t\t\tthrow `Bad skin size: ${image.width}x${image.height}`;\n\t\t}\n\t}\n\n\tlet context = canvas.getContext(\"2d\");\n\tif (isOldFormat) {\n\t\tlet sideLength = image.width;\n\t\tcanvas.width = sideLength;\n\t\tcanvas.height = sideLength;\n\t\tcontext.clearRect(0, 0, sideLength, sideLength);\n\t\tcontext.drawImage(image, 0, 0, sideLength, sideLength / 2.0);\n\t\tconvertSkinTo1_8(context, sideLength);\n\t} else {\n\t\tcanvas.width = image.width;\n\t\tcanvas.height = image.height;\n\t\tcontext.clearRect(0, 0, image.width, image.height);\n\t\tcontext.drawImage(image, 0, 0, canvas.width, canvas.height);\n\t}\n}\n\nfunction loadCapeToCanvas(canvas, image) {\n\tlet isOldFormat = false;\n\tif (image.width !== 2 * image.height) {\n\t\tif (image.width * 17 == image.height * 22) {\n\t\t\t// width/height = 22/17\n\t\t\tisOldFormat = true;\n\t\t} else {\n\t\t\tthrow `Bad cape size: ${image.width}x${image.height}`;\n\t\t}\n\t}\n\n\tlet context = canvas.getContext(\"2d\");\n\tif (isOldFormat) {\n\t\tlet width = image.width * 64 / 22;\n\t\tcanvas.width = width;\n\t\tcanvas.height = width / 2;\n\t} else {\n\t\tcanvas.width = image.width;\n\t\tcanvas.height = image.height;\n\t}\n\tcontext.clearRect(0, 0, canvas.width, canvas.height);\n\tcontext.drawImage(image, 0, 0, image.width, image.height);\n}\n\nfunction isSlimSkin(canvasOrImage) {\n\t// Detects whether the skin is default or slim.\n\t//\n\t// The right arm area of *default* skins:\n\t// (44,16)->*-------*-------*\n\t// (40,20)  |top    |bottom |\n\t// \\|/      |4x4    |4x4    |\n\t//  *-------*-------*-------*-------*\n\t//  |right  |front  |left   |back   |\n\t//  |4x12   |4x12   |4x12   |4x12   |\n\t//  *-------*-------*-------*-------*\n\t// The right arm area of *slim* skins:\n\t// (44,16)->*------*------*-*\n\t// (40,20)  |top   |bottom| |<----[x0=50,y0=16,w=2,h=4]\n\t// \\|/      |3x4   |3x4   | |\n\t//  *-------*------*------***-----*-*\n\t//  |right  |front |left   |back  | |<----[x0=54,y0=20,w=2,h=12]\n\t//  |4x12   |3x12  |4x12   |3x12  | |\n\t//  *-------*------*-------*------*-*\n\t// Compared with default right arms, slim right arms have 2 unused areas.\n\t//\n\t// The same is true for left arm:\n\t// The left arm area of *default* skins:\n\t// (36,48)->*-------*-------*\n\t// (32,52)  |top    |bottom |\n\t// \\|/      |4x4    |4x4    |\n\t//  *-------*-------*-------*-------*\n\t//  |right  |front  |left   |back   |\n\t//  |4x12   |4x12   |4x12   |4x12   |\n\t//  *-------*-------*-------*-------*\n\t// The left arm area of *slim* skins:\n\t// (36,48)->*------*------*-*\n\t// (32,52)  |top   |bottom| |<----[x0=42,y0=48,w=2,h=4]\n\t// \\|/      |3x4   |3x4   | |\n\t//  *-------*------*------***-----*-*\n\t//  |right  |front |left   |back  | |<----[x0=46,y0=52,w=2,h=12]\n\t//  |4x12   |3x12  |4x12   |3x12  | |\n\t//  *-------*------*-------*------*-*\n\t//\n\t// If there is a transparent pixel in any of the 4 unused areas, the skin must be slim,\n\t// as transparent pixels are not allowed in the first layer.\n\n\tif (canvasOrImage instanceof HTMLCanvasElement) {\n\t\tlet canvas = canvasOrImage;\n\t\tlet scale = computeSkinScale(canvas.width);\n\t\tlet context = canvas.getContext(\"2d\");\n\t\tlet checkArea = (x, y, w, h) => hasTransparency(context, x * scale, y * scale, w * scale, h * scale);\n\t\treturn checkArea(50, 16, 2, 4) ||\n\t\t\tcheckArea(54, 20, 2, 12) ||\n\t\t\tcheckArea(42, 48, 2, 4) ||\n\t\t\tcheckArea(46, 52, 2, 12);\n\t} else if (canvasOrImage instanceof HTMLImageElement) {\n\t\tlet image = canvasOrImage;\n\t\tlet canvas = document.createElement(\"canvas\");\n\t\tloadSkinToCanvas(canvas, image);\n\t\treturn isSlimSkin(canvas);\n\t} else {\n\t\tthrow `Illegal argument: ${canvasOrImage}`;\n\t}\n}\n\nexport { isSlimSkin, loadSkinToCanvas, loadCapeToCanvas };\n","import * as THREE from \"three\";\nimport { PlayerObject } from \"./model\";\nimport { invokeAnimation } from \"./animation\";\nimport { loadSkinToCanvas,loadCapeToCanvas, isSlimSkin } from \"./utils\";\n\nclass SkinViewer {\n\tconstructor(options) {\n\t\tthis.domElement = options.domElement;\n\t\tthis.animation = options.animation || null;\n\t\tthis.detectModel = options.animation !== false; // true by default\n\t\tthis.animationPaused = false;\n\t\tthis.animationTime = 0;\n\t\tthis.disposed = false;\n\n\t\t// texture\n\t\tthis.skinImg = new Image();\n\t\tthis.skinCanvas = document.createElement(\"canvas\");\n\t\tthis.skinTexture = new THREE.Texture(this.skinCanvas);\n\t\tthis.skinTexture.magFilter = THREE.NearestFilter;\n\t\tthis.skinTexture.minFilter = THREE.NearestFilter;\n\n\t\tthis.capeImg = new Image();\n\t\tthis.capeCanvas = document.createElement(\"canvas\");\n\t\tthis.capeTexture = new THREE.Texture(this.capeCanvas);\n\t\tthis.capeTexture.magFilter = THREE.NearestFilter;\n\t\tthis.capeTexture.minFilter = THREE.NearestFilter;\n\n\t\tthis.layer1Material = new THREE.MeshBasicMaterial({ map: this.skinTexture, side: THREE.FrontSide });\n\t\tthis.layer2Material = new THREE.MeshBasicMaterial({ map: this.skinTexture, transparent: true, opacity: 1, side: THREE.DoubleSide, alphaTest: 0.5 });\n\t\tthis.capeMaterial = new THREE.MeshBasicMaterial({ map: this.capeTexture, transparent: true, opacity: 1, side: THREE.DoubleSide, alphaTest: 0.5 });\n\n\t\t// scene\n\t\tthis.scene = new THREE.Scene();\n\n\t\t// Use smaller fov to avoid distortion\n\t\tthis.camera = new THREE.PerspectiveCamera(40);\n\t\tthis.camera.position.y = -12;\n\t\tthis.camera.position.z = 60;\n\n\t\tthis.renderer = new THREE.WebGLRenderer({ angleRot: true, alpha: true, antialias: false });\n\t\tthis.renderer.setSize(300, 300); // default size\n\t\tthis.renderer.context.getShaderInfoLog = () => \"\"; // shut firefox up\n\t\tthis.domElement.appendChild(this.renderer.domElement);\n\n\t\tthis.playerObject = new PlayerObject(this.layer1Material, this.layer2Material, this.capeMaterial);\n\t\tthis.scene.add(this.playerObject);\n\n\t\t// texture loading\n\t\tthis.skinImg.crossOrigin = \"anonymous\";\n\t\tthis.skinImg.onerror = () => console.error(\"Failed loading \" + this.skinImg.src);\n\t\tthis.skinImg.onload = () => {\n\t\t\tloadSkinToCanvas(this.skinCanvas, this.skinImg);\n\n\t\t\tif (this.detectModel) {\n\t\t\t\tthis.playerObject.skin.slim = isSlimSkin(this.skinCanvas);\n\t\t\t}\n\n\t\t\tthis.skinTexture.needsUpdate = true;\n\t\t\tthis.layer1Material.needsUpdate = true;\n\t\t\tthis.layer2Material.needsUpdate = true;\n\n\t\t\tthis.playerObject.skin.visible = true;\n\t\t};\n\n\t\tthis.capeImg.crossOrigin = \"anonymous\";\n\t\tthis.capeImg.onerror = () => console.error(\"Failed loading \" + this.capeImg.src);\n\t\tthis.capeImg.onload = () => {\n\t\t\tloadCapeToCanvas(this.capeCanvas, this.capeImg);\n\n\t\t\tthis.capeTexture.needsUpdate = true;\n\t\t\tthis.capeMaterial.needsUpdate = true;\n\n\t\t\tthis.playerObject.cape.visible = true;\n\t\t};\n\n\t\tif (options.skinUrl) this.skinUrl = options.skinUrl;\n\t\tif (options.capeUrl) this.capeUrl = options.capeUrl;\n\t\tif (options.width) this.width = options.width;\n\t\tif (options.height) this.height = options.height;\n\n\t\tlet draw = () => {\n\t\t\tif (this.disposed) return;\n\t\t\twindow.requestAnimationFrame(draw);\n\t\t\tif (!this.animationPaused) {\n\t\t\t\tthis.animationTime++;\n\t\t\t\tif (this.animation) {\n\t\t\t\t\tinvokeAnimation(this.animation, this.playerObject, this.animationTime / 100.0);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.renderer.render(this.scene, this.camera);\n\t\t};\n\t\tdraw();\n\t}\n\n\tsetSize(width, height) {\n\t\tthis.camera.aspect = width / height;\n\t\tthis.camera.updateProjectionMatrix();\n\t\tthis.renderer.setSize(width, height);\n\t}\n\n\tdispose() {\n\t\tthis.disposed = true;\n\t\tthis.domElement.removeChild(this.renderer.domElement);\n\t\tthis.renderer.dispose();\n\t\tthis.skinTexture.dispose();\n\t\tthis.capeTexture.dispose();\n\t}\n\n\tget skinUrl() {\n\t\treturn this.skinImg.src;\n\t}\n\n\tset skinUrl(url) {\n\t\tthis.skinImg.src = url;\n\t}\n\n\tget capeUrl() {\n\t\treturn this.capeImg.src;\n\t}\n\n\tset capeUrl(url) {\n\t\tthis.capeImg.src = url;\n\t}\n\n\tget width() {\n\t\treturn this.renderer.getSize().width;\n\t}\n\n\tset width(newWidth) {\n\t\tthis.setSize(newWidth, this.height);\n\t}\n\n\tget height() {\n\t\treturn this.renderer.getSize().height;\n\t}\n\n\tset height(newHeight) {\n\t\tthis.setSize(this.width, newHeight);\n\t}\n}\n\nexport { SkinViewer };\n","import * as THREE from \"three\";\n\nclass OrbitControls extends THREE.EventDispatcher {\n\t/**\n\t * @preserve\n\t * The code was originally from https://github.com/mrdoob/three.js/blob/d45a042cf962e9b1aa9441810ba118647b48aacb/examples/js/controls/OrbitControls.js\n\t */\n\t/**\n\t * @license\n\t * Copyright (C) 2010-2017 three.js authors\n\t *\n\t * Permission is hereby granted, free of charge, to any person obtaining a copy\n\t * of this software and associated documentation files (the \"Software\"), to deal\n\t * in the Software without restriction, including without limitation the rights\n\t * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n\t * copies of the Software, and to permit persons to whom the Software is\n\t * furnished to do so, subject to the following conditions:\n\t *\n\t * The above copyright notice and this permission notice shall be included in\n\t * all copies or substantial portions of the Software.\n\t *\n\t * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n\t * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n\t * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n\t * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n\t * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n\t * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n\t * THE SOFTWARE.\n\t *\n\t *\n\t * @author qiao / https://github.com/qiao\n\t * @author mrdoob / http://mrdoob.com\n\t * @author alteredq / http://alteredqualia.com/\n\t * @author WestLangley / http://github.com/WestLangley\n\t * @author erich666 / http://erichaines.com\n\t */\n\n\t// This set of controls performs orbiting, dollying (zooming), and panning.\n\t// Unlike TrackballControls, it maintains the \"up\" direction object.up (+Y by default).\n\t//\n\t//    Orbit - left mouse / touch: one finger move\n\t//    Zoom - middle mouse, or mousewheel / touch: two finger spread or squish\n\t//    Pan - right mouse, or arrow keys / touch: three finger swipe\n\n\tconstructor(object, domElement) {\n\t\tsuper();\n\t\tthis.object = object;\n\t\tthis.domElement = (domElement !== undefined) ? domElement : document;\n\n\t\t// Set to false to disable this control\n\t\tthis.enabled = true;\n\n\t\t// \"target\" sets the location of focus, where the object orbits around\n\t\tthis.target = new THREE.Vector3();\n\n\t\t// How far you can dolly in and out (PerspectiveCamera only)\n\t\tthis.minDistance = 0;\n\t\tthis.maxDistance = Infinity;\n\n\t\t// How far you can zoom in and out (OrthographicCamera only)\n\t\tthis.minZoom = 0;\n\t\tthis.maxZoom = Infinity;\n\n\t\t// How far you can orbit vertically, upper and lower limits.\n\t\t// Range is 0 to Math.PI radians.\n\t\tthis.minPolarAngle = 0; // radians\n\t\tthis.maxPolarAngle = Math.PI; // radians\n\n\t\t// How far you can orbit horizontally, upper and lower limits.\n\t\t// If set, must be a sub-interval of the interval [ - Math.PI, Math.PI ].\n\t\tthis.minAzimuthAngle = -Infinity; // radians\n\t\tthis.maxAzimuthAngle = Infinity; // radians\n\n\t\t// Set to true to enable damping (inertia)\n\t\t// If damping is enabled, you must call controls.update() in your animation loop\n\t\tthis.enableDamping = false;\n\t\tthis.dampingFactor = 0.25;\n\n\t\t// This option actually enables dollying in and out; left as \"zoom\" for backwards compatibility.\n\t\t// Set to false to disable zooming\n\t\tthis.enableZoom = true;\n\t\tthis.zoomSpeed = 1.0;\n\n\t\t// Set to false to disable rotating\n\t\tthis.enableRotate = true;\n\t\tthis.rotateSpeed = 1.0;\n\n\t\t// Set to false to disable panning\n\t\tthis.enablePan = true;\n\t\tthis.keyPanSpeed = 7.0; // pixels moved per arrow key push\n\n\t\t// Set to true to automatically rotate around the target\n\t\t// If auto-rotate is enabled, you must call controls.update() in your animation loop\n\t\tthis.autoRotate = false;\n\t\tthis.autoRotateSpeed = 2.0; // 30 seconds per round when fps is 60\n\n\t\t// Set to false to disable use of the keys\n\t\tthis.enableKeys = true;\n\n\t\t// The four arrow keys\n\t\tthis.keys = { LEFT: 37, UP: 38, RIGHT: 39, BOTTOM: 40 };\n\n\t\t// Mouse buttons\n\t\tthis.mouseButtons = { ORBIT: THREE.MOUSE.LEFT, ZOOM: THREE.MOUSE.MIDDLE, PAN: THREE.MOUSE.RIGHT };\n\n\t\t// for reset\n\t\tthis.target0 = this.target.clone();\n\t\tthis.position0 = this.object.position.clone();\n\t\tthis.zoom0 = this.object.zoom;\n\n\t\t//\n\t\t// public methods\n\t\t//\n\t\tthis.getPolarAngle = function () {\n\t\t\treturn spherical.phi;\n\t\t};\n\t\tthis.getAzimuthalAngle = function () {\n\t\t\treturn spherical.theta;\n\t\t};\n\t\tthis.saveState = function () {\n\t\t\tscope.target0.copy(scope.target);\n\t\t\tscope.position0.copy(scope.object.position);\n\t\t\tscope.zoom0 = scope.object.zoom;\n\t\t};\n\t\tthis.reset = function () {\n\t\t\tscope.target.copy(scope.target0);\n\t\t\tscope.object.position.copy(scope.position0);\n\t\t\tscope.object.zoom = scope.zoom0;\n\t\t\tscope.object.updateProjectionMatrix();\n\t\t\tscope.dispatchEvent(changeEvent);\n\t\t\tscope.update();\n\t\t\tstate = STATE.NONE;\n\t\t};\n\n\t\t// this method is exposed, but perhaps it would be better if we can make it private...\n\t\tthis.update = function () {\n\t\t\tlet offset = new THREE.Vector3();\n\t\t\t// so camera.up is the orbit axis\n\t\t\tlet quat = new THREE.Quaternion().setFromUnitVectors(object.up, new THREE.Vector3(0, 1, 0));\n\t\t\tlet quatInverse = quat.clone().inverse();\n\t\t\tlet lastPosition = new THREE.Vector3();\n\t\t\tlet lastQuaternion = new THREE.Quaternion();\n\t\t\treturn function update() {\n\t\t\t\tlet position = scope.object.position;\n\t\t\t\toffset.copy(position).sub(scope.target);\n\t\t\t\t// rotate offset to \"y-axis-is-up\" space\n\t\t\t\toffset.applyQuaternion(quat);\n\t\t\t\t// angle from z-axis around y-axis\n\t\t\t\tspherical.setFromVector3(offset);\n\t\t\t\tif (scope.autoRotate && state === STATE.NONE) {\n\t\t\t\t\trotateLeft(getAutoRotationAngle());\n\t\t\t\t}\n\t\t\t\tspherical.theta += sphericalDelta.theta;\n\t\t\t\tspherical.phi += sphericalDelta.phi;\n\t\t\t\t// restrict theta to be between desired limits\n\t\t\t\tspherical.theta = Math.max(scope.minAzimuthAngle, Math.min(scope.maxAzimuthAngle, spherical.theta));\n\t\t\t\t// restrict phi to be between desired limits\n\t\t\t\tspherical.phi = Math.max(scope.minPolarAngle, Math.min(scope.maxPolarAngle, spherical.phi));\n\t\t\t\tspherical.makeSafe();\n\t\t\t\tspherical.radius *= scale;\n\t\t\t\t// restrict radius to be between desired limits\n\t\t\t\tspherical.radius = Math.max(scope.minDistance, Math.min(scope.maxDistance, spherical.radius));\n\t\t\t\t// move target to panned location\n\t\t\t\tscope.target.add(panOffset);\n\t\t\t\toffset.setFromSpherical(spherical);\n\t\t\t\t// rotate offset back to \"camera-up-vector-is-up\" space\n\t\t\t\toffset.applyQuaternion(quatInverse);\n\t\t\t\tposition.copy(scope.target).add(offset);\n\t\t\t\tscope.object.lookAt(scope.target);\n\t\t\t\tif (scope.enableDamping === true) {\n\t\t\t\t\tsphericalDelta.theta *= (1 - scope.dampingFactor);\n\t\t\t\t\tsphericalDelta.phi *= (1 - scope.dampingFactor);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tsphericalDelta.set(0, 0, 0);\n\t\t\t\t}\n\t\t\t\tscale = 1;\n\t\t\t\tpanOffset.set(0, 0, 0);\n\t\t\t\t// update condition is:\n\t\t\t\t// min(camera displacement, camera rotation in radians)^2 > EPS\n\t\t\t\t// using small-angle approximation cos(x/2) = 1 - x^2 / 8\n\t\t\t\tif (zoomChanged ||\n\t\t\t\t\tlastPosition.distanceToSquared(scope.object.position) > EPS ||\n\t\t\t\t\t8 * (1 - lastQuaternion.dot(scope.object.quaternion)) > EPS) {\n\t\t\t\t\tscope.dispatchEvent(changeEvent);\n\t\t\t\t\tlastPosition.copy(scope.object.position);\n\t\t\t\t\tlastQuaternion.copy(scope.object.quaternion);\n\t\t\t\t\tzoomChanged = false;\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t};\n\t\t}();\n\t\tthis.dispose = function () {\n\t\t\tscope.domElement.removeEventListener(\"contextmenu\", onContextMenu, false);\n\t\t\tscope.domElement.removeEventListener(\"mousedown\", onMouseDown, false);\n\t\t\tscope.domElement.removeEventListener(\"wheel\", onMouseWheel, false);\n\t\t\tscope.domElement.removeEventListener(\"touchstart\", onTouchStart, false);\n\t\t\tscope.domElement.removeEventListener(\"touchend\", onTouchEnd, false);\n\t\t\tscope.domElement.removeEventListener(\"touchmove\", onTouchMove, false);\n\t\t\tdocument.removeEventListener(\"mousemove\", onMouseMove, false);\n\t\t\tdocument.removeEventListener(\"mouseup\", onMouseUp, false);\n\t\t\twindow.removeEventListener(\"keydown\", onKeyDown, false);\n\t\t\t//scope.dispatchEvent({ type: \"dispose\" }); // should this be added here?\n\t\t};\n\t\t//\n\t\t// internals\n\t\t//\n\t\tlet scope = this;\n\t\tlet changeEvent = { type: \"change\" };\n\t\tlet startEvent = { type: \"start\" };\n\t\tlet endEvent = { type: \"end\" };\n\t\tlet STATE = { NONE: -1, ROTATE: 0, DOLLY: 1, PAN: 2, TOUCH_ROTATE: 3, TOUCH_DOLLY: 4, TOUCH_PAN: 5 };\n\t\tlet state = STATE.NONE;\n\t\tlet EPS = 0.000001;\n\t\t// current position in spherical coordinates\n\t\tlet spherical = new THREE.Spherical();\n\t\tlet sphericalDelta = new THREE.Spherical();\n\t\tlet scale = 1;\n\t\tlet panOffset = new THREE.Vector3();\n\t\tlet zoomChanged = false;\n\t\tlet rotateStart = new THREE.Vector2();\n\t\tlet rotateEnd = new THREE.Vector2();\n\t\tlet rotateDelta = new THREE.Vector2();\n\t\tlet panStart = new THREE.Vector2();\n\t\tlet panEnd = new THREE.Vector2();\n\t\tlet panDelta = new THREE.Vector2();\n\t\tlet dollyStart = new THREE.Vector2();\n\t\tlet dollyEnd = new THREE.Vector2();\n\t\tlet dollyDelta = new THREE.Vector2();\n\t\tfunction getAutoRotationAngle() {\n\t\t\treturn 2 * Math.PI / 60 / 60 * scope.autoRotateSpeed;\n\t\t}\n\t\tfunction getZoomScale() {\n\t\t\treturn Math.pow(0.95, scope.zoomSpeed);\n\t\t}\n\t\tfunction rotateLeft(angle) {\n\t\t\tsphericalDelta.theta -= angle;\n\t\t}\n\t\tfunction rotateUp(angle) {\n\t\t\tsphericalDelta.phi -= angle;\n\t\t}\n\t\tlet panLeft = function () {\n\t\t\tlet v = new THREE.Vector3();\n\t\t\treturn function panLeft(distance, objectMatrix) {\n\t\t\t\tv.setFromMatrixColumn(objectMatrix, 0); // get X column of objectMatrix\n\t\t\t\tv.multiplyScalar(-distance);\n\t\t\t\tpanOffset.add(v);\n\t\t\t};\n\t\t}();\n\t\tlet panUp = function () {\n\t\t\tlet v = new THREE.Vector3();\n\t\t\treturn function panUp(distance, objectMatrix) {\n\t\t\t\tv.setFromMatrixColumn(objectMatrix, 1); // get Y column of objectMatrix\n\t\t\t\tv.multiplyScalar(distance);\n\t\t\t\tpanOffset.add(v);\n\t\t\t};\n\t\t}();\n\t\t// deltaX and deltaY are in pixels; right and down are positive\n\t\tlet pan = function () {\n\t\t\tlet offset = new THREE.Vector3();\n\t\t\treturn function pan(deltaX, deltaY) {\n\t\t\t\tlet element = scope.domElement === document ? scope.domElement.body : scope.domElement;\n\t\t\t\tif (scope.object instanceof THREE.PerspectiveCamera) {\n\t\t\t\t\t// perspective\n\t\t\t\t\tlet position = scope.object.position;\n\t\t\t\t\toffset.copy(position).sub(scope.target);\n\t\t\t\t\tlet targetDistance = offset.length();\n\t\t\t\t\t// half of the fov is center to top of screen\n\t\t\t\t\ttargetDistance *= Math.tan((scope.object.fov / 2) * Math.PI / 180.0);\n\t\t\t\t\t// we actually don't use screenWidth, since perspective camera is fixed to screen height\n\t\t\t\t\tpanLeft(2 * deltaX * targetDistance / element.clientHeight, scope.object.matrix);\n\t\t\t\t\tpanUp(2 * deltaY * targetDistance / element.clientHeight, scope.object.matrix);\n\t\t\t\t}\n\t\t\t\telse if (scope.object instanceof THREE.OrthographicCamera) {\n\t\t\t\t\t// orthographic\n\t\t\t\t\tpanLeft(deltaX * (scope.object.right - scope.object.left) / scope.object.zoom / element.clientWidth, scope.object.matrix);\n\t\t\t\t\tpanUp(deltaY * (scope.object.top - scope.object.bottom) / scope.object.zoom / element.clientHeight, scope.object.matrix);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// camera neither orthographic nor perspective\n\t\t\t\t\tconsole.warn(\"WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.\");\n\t\t\t\t\tscope.enablePan = false;\n\t\t\t\t}\n\t\t\t};\n\t\t}();\n\t\tfunction dollyIn(dollyScale) {\n\t\t\tif (scope.object instanceof THREE.PerspectiveCamera) {\n\t\t\t\tscale /= dollyScale;\n\t\t\t}\n\t\t\telse if (scope.object instanceof THREE.OrthographicCamera) {\n\t\t\t\tscope.object.zoom = Math.max(scope.minZoom, Math.min(scope.maxZoom, scope.object.zoom * dollyScale));\n\t\t\t\tscope.object.updateProjectionMatrix();\n\t\t\t\tzoomChanged = true;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tconsole.warn(\"WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.\");\n\t\t\t\tscope.enableZoom = false;\n\t\t\t}\n\t\t}\n\t\tfunction dollyOut(dollyScale) {\n\t\t\tif (scope.object instanceof THREE.PerspectiveCamera) {\n\t\t\t\tscale *= dollyScale;\n\t\t\t}\n\t\t\telse if (scope.object instanceof THREE.OrthographicCamera) {\n\t\t\t\tscope.object.zoom = Math.max(scope.minZoom, Math.min(scope.maxZoom, scope.object.zoom / dollyScale));\n\t\t\t\tscope.object.updateProjectionMatrix();\n\t\t\t\tzoomChanged = true;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tconsole.warn(\"WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.\");\n\t\t\t\tscope.enableZoom = false;\n\t\t\t}\n\t\t}\n\t\t//\n\t\t// event callbacks - update the object state\n\t\t//\n\t\tfunction handleMouseDownRotate(event) {\n\t\t\trotateStart.set(event.clientX, event.clientY);\n\t\t}\n\t\tfunction handleMouseDownDolly(event) {\n\t\t\tdollyStart.set(event.clientX, event.clientY);\n\t\t}\n\t\tfunction handleMouseDownPan(event) {\n\t\t\tpanStart.set(event.clientX, event.clientY);\n\t\t}\n\t\tfunction handleMouseMoveRotate(event) {\n\t\t\trotateEnd.set(event.clientX, event.clientY);\n\t\t\trotateDelta.subVectors(rotateEnd, rotateStart);\n\t\t\tlet element = scope.domElement === document ? scope.domElement.body : scope.domElement;\n\t\t\t// rotating across whole screen goes 360 degrees around\n\t\t\trotateLeft(2 * Math.PI * rotateDelta.x / element.clientWidth * scope.rotateSpeed);\n\t\t\t// rotating up and down along whole screen attempts to go 360, but limited to 180\n\t\t\trotateUp(2 * Math.PI * rotateDelta.y / element.clientHeight * scope.rotateSpeed);\n\t\t\trotateStart.copy(rotateEnd);\n\t\t\tscope.update();\n\t\t}\n\t\tfunction handleMouseMoveDolly(event) {\n\t\t\tdollyEnd.set(event.clientX, event.clientY);\n\t\t\tdollyDelta.subVectors(dollyEnd, dollyStart);\n\t\t\tif (dollyDelta.y > 0) {\n\t\t\t\tdollyIn(getZoomScale());\n\t\t\t}\n\t\t\telse if (dollyDelta.y < 0) {\n\t\t\t\tdollyOut(getZoomScale());\n\t\t\t}\n\t\t\tdollyStart.copy(dollyEnd);\n\t\t\tscope.update();\n\t\t}\n\t\tfunction handleMouseMovePan(event) {\n\t\t\tpanEnd.set(event.clientX, event.clientY);\n\t\t\tpanDelta.subVectors(panEnd, panStart);\n\t\t\tpan(panDelta.x, panDelta.y);\n\t\t\tpanStart.copy(panEnd);\n\t\t\tscope.update();\n\t\t}\n\t\tfunction handleMouseUp(event) {\n\t\t}\n\t\tfunction handleMouseWheel(event) {\n\t\t\tif (event.deltaY < 0) {\n\t\t\t\tdollyOut(getZoomScale());\n\t\t\t}\n\t\t\telse if (event.deltaY > 0) {\n\t\t\t\tdollyIn(getZoomScale());\n\t\t\t}\n\t\t\tscope.update();\n\t\t}\n\t\tfunction handleKeyDown(event) {\n\t\t\tswitch (event.keyCode) {\n\t\t\t\tcase scope.keys.UP:\n\t\t\t\t\tpan(0, scope.keyPanSpeed);\n\t\t\t\t\tscope.update();\n\t\t\t\t\tbreak;\n\t\t\t\tcase scope.keys.BOTTOM:\n\t\t\t\t\tpan(0, -scope.keyPanSpeed);\n\t\t\t\t\tscope.update();\n\t\t\t\t\tbreak;\n\t\t\t\tcase scope.keys.LEFT:\n\t\t\t\t\tpan(scope.keyPanSpeed, 0);\n\t\t\t\t\tscope.update();\n\t\t\t\t\tbreak;\n\t\t\t\tcase scope.keys.RIGHT:\n\t\t\t\t\tpan(-scope.keyPanSpeed, 0);\n\t\t\t\t\tscope.update();\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tfunction handleTouchStartRotate(event) {\n\t\t\trotateStart.set(event.touches[0].pageX, event.touches[0].pageY);\n\t\t}\n\t\tfunction handleTouchStartDolly(event) {\n\t\t\tlet dx = event.touches[0].pageX - event.touches[1].pageX;\n\t\t\tlet dy = event.touches[0].pageY - event.touches[1].pageY;\n\t\t\tlet distance = Math.sqrt(dx * dx + dy * dy);\n\t\t\tdollyStart.set(0, distance);\n\t\t}\n\t\tfunction handleTouchStartPan(event) {\n\t\t\tpanStart.set(event.touches[0].pageX, event.touches[0].pageY);\n\t\t}\n\t\tfunction handleTouchMoveRotate(event) {\n\t\t\trotateEnd.set(event.touches[0].pageX, event.touches[0].pageY);\n\t\t\trotateDelta.subVectors(rotateEnd, rotateStart);\n\t\t\tlet element = scope.domElement === document ? scope.domElement.body : scope.domElement;\n\t\t\trotateLeft(2 * Math.PI * rotateDelta.x / element.clientWidth * scope.rotateSpeed);\n\t\t\trotateUp(2 * Math.PI * rotateDelta.y / element.clientHeight * scope.rotateSpeed);\n\t\t\trotateStart.copy(rotateEnd);\n\t\t\tscope.update();\n\t\t}\n\t\tfunction handleTouchMoveDolly(event) {\n\t\t\tlet dx = event.touches[0].pageX - event.touches[1].pageX;\n\t\t\tlet dy = event.touches[0].pageY - event.touches[1].pageY;\n\t\t\tlet distance = Math.sqrt(dx * dx + dy * dy);\n\t\t\tdollyEnd.set(0, distance);\n\t\t\tdollyDelta.subVectors(dollyEnd, dollyStart);\n\t\t\tif (dollyDelta.y > 0) {\n\t\t\t\tdollyOut(getZoomScale());\n\t\t\t}\n\t\t\telse if (dollyDelta.y < 0) {\n\t\t\t\tdollyIn(getZoomScale());\n\t\t\t}\n\t\t\tdollyStart.copy(dollyEnd);\n\t\t\tscope.update();\n\t\t}\n\t\tfunction handleTouchMovePan(event) {\n\t\t\tpanEnd.set(event.touches[0].pageX, event.touches[0].pageY);\n\t\t\tpanDelta.subVectors(panEnd, panStart);\n\t\t\tpan(panDelta.x, panDelta.y);\n\t\t\tpanStart.copy(panEnd);\n\t\t\tscope.update();\n\t\t}\n\t\tfunction handleTouchEnd(event) {\n\t\t}\n\t\t//\n\t\t// event handlers - FSM: listen for events and reset state\n\t\t//\n\t\tfunction onMouseDown(event) {\n\t\t\tif (scope.enabled === false)\n\t\t\t\treturn;\n\t\t\tswitch (event.button) {\n\t\t\t\tcase scope.mouseButtons.ORBIT:\n\t\t\t\t\tif (scope.enableRotate === false)\n\t\t\t\t\t\treturn;\n\t\t\t\t\thandleMouseDownRotate(event);\n\t\t\t\t\tstate = STATE.ROTATE;\n\t\t\t\t\tbreak;\n\t\t\t\tcase scope.mouseButtons.ZOOM:\n\t\t\t\t\tif (scope.enableZoom === false)\n\t\t\t\t\t\treturn;\n\t\t\t\t\thandleMouseDownDolly(event);\n\t\t\t\t\tstate = STATE.DOLLY;\n\t\t\t\t\tbreak;\n\t\t\t\tcase scope.mouseButtons.PAN:\n\t\t\t\t\tif (scope.enablePan === false)\n\t\t\t\t\t\treturn;\n\t\t\t\t\thandleMouseDownPan(event);\n\t\t\t\t\tstate = STATE.PAN;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tevent.preventDefault();\n\t\t\tif (state !== STATE.NONE) {\n\t\t\t\tdocument.addEventListener(\"mousemove\", onMouseMove, false);\n\t\t\t\tdocument.addEventListener(\"mouseup\", onMouseUp, false);\n\t\t\t\tscope.dispatchEvent(startEvent);\n\t\t\t}\n\t\t}\n\t\tfunction onMouseMove(event) {\n\t\t\tif (scope.enabled === false)\n\t\t\t\treturn;\n\t\t\tswitch (state) {\n\t\t\t\tcase STATE.ROTATE:\n\t\t\t\t\tif (scope.enableRotate === false)\n\t\t\t\t\t\treturn;\n\t\t\t\t\thandleMouseMoveRotate(event);\n\t\t\t\t\tbreak;\n\t\t\t\tcase STATE.DOLLY:\n\t\t\t\t\tif (scope.enableZoom === false)\n\t\t\t\t\t\treturn;\n\t\t\t\t\thandleMouseMoveDolly(event);\n\t\t\t\t\tbreak;\n\t\t\t\tcase STATE.PAN:\n\t\t\t\t\tif (scope.enablePan === false)\n\t\t\t\t\t\treturn;\n\t\t\t\t\thandleMouseMovePan(event);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tevent.preventDefault();\n\t\t}\n\t\tfunction onMouseUp(event) {\n\t\t\tif (scope.enabled === false)\n\t\t\t\treturn;\n\t\t\thandleMouseUp(event);\n\t\t\tdocument.removeEventListener(\"mousemove\", onMouseMove, false);\n\t\t\tdocument.removeEventListener(\"mouseup\", onMouseUp, false);\n\t\t\tscope.dispatchEvent(endEvent);\n\t\t\tstate = STATE.NONE;\n\t\t}\n\t\tfunction onMouseWheel(event) {\n\t\t\tif (scope.enabled === false || scope.enableZoom === false || (state !== STATE.NONE && state !== STATE.ROTATE))\n\t\t\t\treturn;\n\t\t\tevent.preventDefault();\n\t\t\tevent.stopPropagation();\n\t\t\thandleMouseWheel(event);\n\t\t\tscope.dispatchEvent(startEvent); // not sure why these are here...\n\t\t\tscope.dispatchEvent(endEvent);\n\t\t}\n\t\tfunction onKeyDown(event) {\n\t\t\tif (scope.enabled === false || scope.enableKeys === false || scope.enablePan === false)\n\t\t\t\treturn;\n\t\t\thandleKeyDown(event);\n\t\t}\n\t\tfunction onTouchStart(event) {\n\t\t\tif (scope.enabled === false)\n\t\t\t\treturn;\n\t\t\tswitch (event.touches.length) {\n\t\t\t\tcase 1:// one-fingered touch: rotate\n\t\t\t\t\tif (scope.enableRotate === false)\n\t\t\t\t\t\treturn;\n\t\t\t\t\thandleTouchStartRotate(event);\n\t\t\t\t\tstate = STATE.TOUCH_ROTATE;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 2:// two-fingered touch: dolly\n\t\t\t\t\tif (scope.enableZoom === false)\n\t\t\t\t\t\treturn;\n\t\t\t\t\thandleTouchStartDolly(event);\n\t\t\t\t\tstate = STATE.TOUCH_DOLLY;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 3:// three-fingered touch: pan\n\t\t\t\t\tif (scope.enablePan === false)\n\t\t\t\t\t\treturn;\n\t\t\t\t\thandleTouchStartPan(event);\n\t\t\t\t\tstate = STATE.TOUCH_PAN;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tstate = STATE.NONE;\n\t\t\t}\n\t\t\tif (state !== STATE.NONE) {\n\t\t\t\tscope.dispatchEvent(startEvent);\n\t\t\t}\n\t\t}\n\t\tfunction onTouchMove(event) {\n\t\t\tif (scope.enabled === false)\n\t\t\t\treturn;\n\t\t\tswitch (event.touches.length) {\n\t\t\t\tcase 1:// one-fingered touch: rotate\n\t\t\t\t\tif (scope.enableRotate === false)\n\t\t\t\t\t\treturn;\n\t\t\t\t\tif (state !== STATE.TOUCH_ROTATE)\n\t\t\t\t\t\treturn; // is this needed?...\n\t\t\t\t\thandleTouchMoveRotate(event);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 2:// two-fingered touch: dolly\n\t\t\t\t\tif (scope.enableZoom === false)\n\t\t\t\t\t\treturn;\n\t\t\t\t\tif (state !== STATE.TOUCH_DOLLY)\n\t\t\t\t\t\treturn; // is this needed?...\n\t\t\t\t\thandleTouchMoveDolly(event);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 3:// three-fingered touch: pan\n\t\t\t\t\tif (scope.enablePan === false)\n\t\t\t\t\t\treturn;\n\t\t\t\t\tif (state !== STATE.TOUCH_PAN)\n\t\t\t\t\t\treturn; // is this needed?...\n\t\t\t\t\thandleTouchMovePan(event);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tstate = STATE.NONE;\n\t\t\t}\n\t\t\tevent.preventDefault();\n\t\t\tevent.stopPropagation();\n\t\t}\n\t\tfunction onTouchEnd(event) {\n\t\t\tif (scope.enabled === false)\n\t\t\t\treturn;\n\t\t\thandleTouchEnd(event);\n\t\t\tscope.dispatchEvent(endEvent);\n\t\t\tstate = STATE.NONE;\n\t\t}\n\t\tfunction onContextMenu(event) {\n\t\t\tif (scope.enabled === false || scope.enablePan === false)\n\t\t\t\treturn;\n\t\t\tevent.preventDefault();\n\t\t}\n\t\t//\n\t\tscope.domElement.addEventListener(\"contextmenu\", onContextMenu, false);\n\t\tscope.domElement.addEventListener(\"mousedown\", onMouseDown, false);\n\t\tscope.domElement.addEventListener(\"wheel\", onMouseWheel, false);\n\t\tscope.domElement.addEventListener(\"touchstart\", onTouchStart, false);\n\t\tscope.domElement.addEventListener(\"touchend\", onTouchEnd, false);\n\t\tscope.domElement.addEventListener(\"touchmove\", onTouchMove, false);\n\t\twindow.addEventListener(\"keydown\", onKeyDown, false);\n\t\t// force an update at start\n\t\tthis.update();\n\t}\n}\n\nfunction createOrbitControls(skinViewer) {\n\tlet control = new OrbitControls(skinViewer.camera, skinViewer.renderer.domElement);\n\n\t// default configuration\n\tcontrol.enablePan = false;\n\tcontrol.target = new THREE.Vector3(0, -12, 0);\n\tcontrol.minDistance = 10;\n\tcontrol.maxDistance = 256;\n\tcontrol.update();\n\n\treturn control;\n}\n\nexport { OrbitControls, createOrbitControls };\n"],"names":["toFaceVertices","x1","y1","x2","y2","w","h","THREE","toSkinVertices","toCapeVertices","setVertices","box","top","bottom","left","front","right","back","faceVertexUvs","esp","SkinObject","layer1Material","layer2Material","modelListeners","head","headBox","headMesh","add","head2Box","head2Mesh","renderOrder","_this","body","bodyBox","bodyMesh","body2Box","body2Mesh","position","y","rightArm","rightArmPivot","rightArmBox","rightArmMesh","push","scale","x","slim","z","uvsNeedUpdate","elementsNeedUpdate","rightArm2Box","rightArm2Mesh","leftArm","leftArmPivot","leftArmBox","leftArmMesh","leftArm2Box","leftArm2Mesh","rightLeg","rightLegPivot","rightLegBox","rightLegMesh","rightLeg2Box","rightLeg2Mesh","leftLeg","leftLegPivot","leftLegBox","leftLegMesh","leftLeg2Box","leftLeg2Mesh","this","_slim","value","forEach","listener","CapeObject","capeMaterial","capeBox","cape","_this2","PlayerObject","skin","visible","_this3","rotation","Math","PI","invokeAnimation","animation","player","time","CompositeAnimation","play","Function","AnimationHandle","paused","_paused","speed","_speed","_lastChange","_lastChangeX","dt","handles","Set","handle","remove","delete","hasTransparency","context","x0","y0","imgData","getImageData","offset","data","computeSkinScale","width","convertSkinTo1_8","copySkin","sX","sY","dX","dY","flipHorizontal","index","index2","pA1","pA2","pA3","pA4","pB1","pB2","pB3","pB4","putImageData","copyImage","clearArea","clearRect","loadSkinToCanvas","canvas","image","isOldFormat","height","getContext","sideLength","drawImage","isSlimSkin","canvasOrImage","HTMLCanvasElement","checkArea","HTMLImageElement","document","createElement","SkinViewer","options","domElement","detectModel","animationPaused","animationTime","disposed","skinImg","Image","skinCanvas","skinTexture","magFilter","minFilter","capeImg","capeCanvas","capeTexture","map","side","transparent","opacity","alphaTest","scene","camera","renderer","angleRot","alpha","antialias","setSize","getShaderInfoLog","appendChild","playerObject","crossOrigin","onerror","console","error","src","onload","needsUpdate","skinUrl","capeUrl","draw","requestAnimationFrame","render","aspect","updateProjectionMatrix","removeChild","dispose","url","getSize","newWidth","newHeight","OrbitControls","object","quat","quatInverse","lastPosition","lastQuaternion","undefined","enabled","target","minDistance","maxDistance","Infinity","minZoom","maxZoom","minPolarAngle","maxPolarAngle","minAzimuthAngle","maxAzimuthAngle","enableDamping","dampingFactor","enableZoom","zoomSpeed","enableRotate","rotateSpeed","enablePan","keyPanSpeed","autoRotate","autoRotateSpeed","enableKeys","keys","LEFT","UP","RIGHT","BOTTOM","mouseButtons","ORBIT","ZOOM","MIDDLE","PAN","target0","clone","position0","zoom0","zoom","getPolarAngle","spherical","phi","getAzimuthalAngle","theta","saveState","copy","scope","reset","dispatchEvent","changeEvent","update","STATE","NONE","setFromUnitVectors","up","inverse","sub","applyQuaternion","setFromVector3","state","sphericalDelta","max","min","makeSafe","radius","panOffset","setFromSpherical","lookAt","set","zoomChanged","distanceToSquared","EPS","dot","quaternion","removeEventListener","onContextMenu","onMouseDown","onMouseWheel","onTouchStart","onTouchEnd","onTouchMove","onMouseMove","onMouseUp","onKeyDown","type","startEvent","endEvent","ROTATE","DOLLY","TOUCH_ROTATE","TOUCH_DOLLY","TOUCH_PAN","rotateStart","rotateEnd","rotateDelta","panStart","panEnd","panDelta","dollyStart","dollyEnd","dollyDelta","getZoomScale","pow","rotateLeft","angle","rotateUp","v","panLeft","distance","objectMatrix","setFromMatrixColumn","multiplyScalar","panUp","pan","deltaX","deltaY","element","targetDistance","length","tan","fov","clientHeight","matrix","clientWidth","warn","dollyIn","dollyScale","dollyOut","event","button","clientX","clientY","preventDefault","addEventListener","subVectors","stopPropagation","keyCode","touches","pageX","pageY","dx","dy","sqrt","skinViewer","control","sin","basicArmRotationZ","cos","basicCapeRotationX"],"mappings":"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"}