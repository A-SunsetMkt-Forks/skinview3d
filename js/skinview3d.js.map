{"version":3,"file":"skinview3d.js","sources":["../src/model.js","../src/orbit_controls.js","../src/animation.js","../src/viewer.js","../src/skinview3d.js"],"sourcesContent":["import * as THREE from \"three\";\r\n\r\nfunction toFaceVertices(x1, y1, x2, y2, w, h) {\r\n\treturn [\r\n\t\tnew THREE.Vector2(x1 / w, 1.0 - y2 / h),\r\n\t\tnew THREE.Vector2(x2 / w, 1.0 - y2 / h),\r\n\t\tnew THREE.Vector2(x2 / w, 1.0 - y1 / h),\r\n\t\tnew THREE.Vector2(x1 / w, 1.0 - y1 / h)\r\n\t];\r\n}\r\n\r\nfunction toSkinVertices(x1, y1, x2, y2) {\r\n\treturn toFaceVertices(x1, y1, x2, y2, 64.0, 64.0);\r\n}\r\n\r\nfunction toCapeVertices(x1, y1, x2, y2) {\r\n\treturn toFaceVertices(x1, y1, x2, y2, 64.0, 32.0);\r\n}\r\n\r\nfunction addVertices(box, top, bottom, left, front, right, back) {\r\n\tbox.faceVertexUvs[0] = [];\r\n\tbox.faceVertexUvs[0][0] = [right[3], right[0], right[2]];\r\n\tbox.faceVertexUvs[0][1] = [right[0], right[1], right[2]];\r\n\tbox.faceVertexUvs[0][2] = [left[3], left[0], left[2]];\r\n\tbox.faceVertexUvs[0][3] = [left[0], left[1], left[2]];\r\n\tbox.faceVertexUvs[0][4] = [top[3], top[0], top[2]];\r\n\tbox.faceVertexUvs[0][5] = [top[0], top[1], top[2]];\r\n\tbox.faceVertexUvs[0][6] = [bottom[0], bottom[3], bottom[1]];\r\n\tbox.faceVertexUvs[0][7] = [bottom[3], bottom[2], bottom[1]];\r\n\tbox.faceVertexUvs[0][8] = [front[3], front[0], front[2]];\r\n\tbox.faceVertexUvs[0][9] = [front[0], front[1], front[2]];\r\n\tbox.faceVertexUvs[0][10] = [back[3], back[0], back[2]];\r\n\tbox.faceVertexUvs[0][11] = [back[0], back[1], back[2]];\r\n}\r\n\r\nconst esp = 0.002;\r\n\r\nclass SkinObject extends THREE.Group {\r\n\tconstructor(isSlim, layer1Material, layer2Material) {\r\n\t\tsuper();\r\n\r\n\t\t// Head\r\n\t\tthis.head = new THREE.Group();\r\n\r\n\t\tlet headBox = new THREE.BoxGeometry(8, 8, 8, 0, 0, 0);\r\n\t\taddVertices(headBox,\r\n\t\t\ttoSkinVertices(8, 0, 16, 8),\r\n\t\t\ttoSkinVertices(16, 0, 24, 8),\r\n\t\t\ttoSkinVertices(0, 8, 8, 16),\r\n\t\t\ttoSkinVertices(8, 8, 16, 16),\r\n\t\t\ttoSkinVertices(16, 8, 24, 16),\r\n\t\t\ttoSkinVertices(24, 8, 32, 16)\r\n\t\t);\r\n\t\tlet headMesh = new THREE.Mesh(headBox, layer1Material);\r\n\t\tthis.head.add(headMesh);\r\n\r\n\t\tlet head2Box = new THREE.BoxGeometry(9, 9, 9, 0, 0, 0);\r\n\t\taddVertices(head2Box,\r\n\t\t\ttoSkinVertices(40, 0, 48, 8),\r\n\t\t\ttoSkinVertices(48, 0, 56, 8),\r\n\t\t\ttoSkinVertices(32, 8, 40, 16),\r\n\t\t\ttoSkinVertices(40, 8, 48, 16),\r\n\t\t\ttoSkinVertices(48, 8, 56, 16),\r\n\t\t\ttoSkinVertices(56, 8, 64, 16)\r\n\t\t);\r\n\t\tlet head2Mesh = new THREE.Mesh(head2Box, layer2Material);\r\n\t\thead2Mesh.renderOrder = -1;\r\n\t\tthis.head.add(head2Mesh);\r\n\r\n\t\tthis.add(this.head);\r\n\r\n\r\n\t\t// Body\r\n\t\tthis.body = new THREE.Group();\r\n\r\n\t\tlet bodyBox = new THREE.BoxGeometry(8, 12, 4, 0, 0, 0);\r\n\t\taddVertices(bodyBox,\r\n\t\t\ttoSkinVertices(20, 16, 28, 20),\r\n\t\t\ttoSkinVertices(28, 16, 36, 20),\r\n\t\t\ttoSkinVertices(16, 20, 20, 32),\r\n\t\t\ttoSkinVertices(20, 20, 28, 32),\r\n\t\t\ttoSkinVertices(28, 20, 32, 32),\r\n\t\t\ttoSkinVertices(32, 20, 40, 32)\r\n\t\t);\r\n\t\tlet bodyMesh = new THREE.Mesh(bodyBox, layer1Material);\r\n\t\tthis.body.add(bodyMesh);\r\n\r\n\t\tlet body2Box = new THREE.BoxGeometry(9, 13.5, 4.5, 0, 0, 0);\r\n\t\taddVertices(body2Box,\r\n\t\t\ttoSkinVertices(20, 32, 28, 36),\r\n\t\t\ttoSkinVertices(28, 32, 36, 36),\r\n\t\t\ttoSkinVertices(16, 36, 20, 48),\r\n\t\t\ttoSkinVertices(20, 36, 28, 48),\r\n\t\t\ttoSkinVertices(28, 36, 32, 48),\r\n\t\t\ttoSkinVertices(32, 36, 40, 48)\r\n\t\t);\r\n\t\tlet body2Mesh = new THREE.Mesh(body2Box, layer2Material);\r\n\t\tthis.body.add(body2Mesh);\r\n\r\n\t\tthis.body.position.y = -10;\r\n\t\tthis.add(this.body);\r\n\r\n\r\n\t\t// Right Arm\r\n\t\tthis.rightArm = new THREE.Group();\r\n\t\tlet rightArmPivot = new THREE.Group();\r\n\r\n\t\tlet rightArmBox = new THREE.BoxGeometry((isSlim ? 3 : 4) - esp, 12 - esp, 4 - esp, 0, 0, 0);\r\n\t\tif (isSlim) {\r\n\t\t\taddVertices(rightArmBox,\r\n\t\t\t\ttoSkinVertices(44, 16, 47, 20),\r\n\t\t\t\ttoSkinVertices(47, 16, 50, 20),\r\n\t\t\t\ttoSkinVertices(40, 20, 44, 32),\r\n\t\t\t\ttoSkinVertices(44, 20, 47, 32),\r\n\t\t\t\ttoSkinVertices(47, 20, 51, 32),\r\n\t\t\t\ttoSkinVertices(51, 20, 54, 32)\r\n\t\t\t);\r\n\t\t} else {\r\n\t\t\taddVertices(rightArmBox,\r\n\t\t\t\ttoSkinVertices(44, 16, 48, 20),\r\n\t\t\t\ttoSkinVertices(48, 16, 52, 20),\r\n\t\t\t\ttoSkinVertices(40, 20, 44, 32),\r\n\t\t\t\ttoSkinVertices(44, 20, 48, 32),\r\n\t\t\t\ttoSkinVertices(48, 20, 52, 32),\r\n\t\t\t\ttoSkinVertices(52, 20, 56, 32)\r\n\t\t\t);\r\n\t\t}\r\n\t\tlet rightArmMesh = new THREE.Mesh(rightArmBox, layer1Material);\r\n\t\trightArmPivot.add(rightArmMesh);\r\n\r\n\t\tlet rightArm2Box = new THREE.BoxGeometry((isSlim ? 3.375 : 4.5) - esp, 13.5 - esp, 4.5 - esp, 0, 0, 0);\r\n\t\tif (isSlim) {\r\n\t\t\taddVertices(rightArm2Box,\r\n\t\t\t\ttoSkinVertices(44, 32, 47, 36),\r\n\t\t\t\ttoSkinVertices(47, 32, 50, 36),\r\n\t\t\t\ttoSkinVertices(40, 36, 44, 48),\r\n\t\t\t\ttoSkinVertices(44, 36, 47, 48),\r\n\t\t\t\ttoSkinVertices(47, 36, 51, 48),\r\n\t\t\t\ttoSkinVertices(51, 36, 54, 48)\r\n\t\t\t);\r\n\t\t} else {\r\n\t\t\taddVertices(rightArm2Box,\r\n\t\t\t\ttoSkinVertices(44, 32, 48, 36),\r\n\t\t\t\ttoSkinVertices(48, 32, 52, 36),\r\n\t\t\t\ttoSkinVertices(40, 36, 44, 48),\r\n\t\t\t\ttoSkinVertices(44, 36, 48, 48),\r\n\t\t\t\ttoSkinVertices(48, 36, 52, 48),\r\n\t\t\t\ttoSkinVertices(52, 36, 56, 48)\r\n\t\t\t);\r\n\t\t}\r\n\t\tlet rightArm2Mesh = new THREE.Mesh(rightArm2Box, layer2Material);\r\n\t\trightArm2Mesh.renderOrder = 1;\r\n\t\trightArmPivot.add(rightArm2Mesh);\r\n\r\n\t\trightArmPivot.position.y = -6;\r\n\t\tthis.rightArm.add(rightArmPivot);\r\n\t\tthis.rightArm.position.y = -4;\r\n\t\tthis.rightArm.position.x = isSlim ? -5.5 : -6;\r\n\t\tthis.add(this.rightArm);\r\n\r\n\r\n\t\t// Left Arm\r\n\t\tthis.leftArm = new THREE.Group();\r\n\t\tlet leftArmPivot = new THREE.Group();\r\n\r\n\t\tlet leftArmBox = new THREE.BoxGeometry((isSlim ? 3 : 4) - esp, 12 - esp, 4 - esp, 0, 0, 0);\r\n\t\tif (isSlim) {\r\n\t\t\taddVertices(leftArmBox,\r\n\t\t\t\ttoSkinVertices(36, 48, 39, 52),\r\n\t\t\t\ttoSkinVertices(39, 48, 42, 52),\r\n\t\t\t\ttoSkinVertices(32, 52, 36, 64),\r\n\t\t\t\ttoSkinVertices(36, 52, 39, 64),\r\n\t\t\t\ttoSkinVertices(39, 52, 43, 64),\r\n\t\t\t\ttoSkinVertices(43, 52, 46, 64)\r\n\t\t\t);\r\n\t\t} else {\r\n\t\t\taddVertices(leftArmBox,\r\n\t\t\t\ttoSkinVertices(36, 48, 40, 52),\r\n\t\t\t\ttoSkinVertices(40, 48, 44, 52),\r\n\t\t\t\ttoSkinVertices(32, 52, 36, 64),\r\n\t\t\t\ttoSkinVertices(36, 52, 40, 64),\r\n\t\t\t\ttoSkinVertices(40, 52, 44, 64),\r\n\t\t\t\ttoSkinVertices(44, 52, 48, 64)\r\n\t\t\t);\r\n\t\t}\r\n\t\tlet leftArmMesh = new THREE.Mesh(leftArmBox, layer1Material);\r\n\t\tleftArmPivot.add(leftArmMesh);\r\n\r\n\t\tlet leftArm2Box = new THREE.BoxGeometry((isSlim ? 3.375 : 4.5) - esp, 13.5 - esp, 4.5 - esp, 0, 0, 0);\r\n\t\tif (isSlim) {\r\n\t\t\taddVertices(leftArm2Box,\r\n\t\t\t\ttoSkinVertices(52, 48, 55, 52),\r\n\t\t\t\ttoSkinVertices(55, 48, 58, 52),\r\n\t\t\t\ttoSkinVertices(48, 52, 52, 64),\r\n\t\t\t\ttoSkinVertices(52, 52, 55, 64),\r\n\t\t\t\ttoSkinVertices(55, 52, 59, 64),\r\n\t\t\t\ttoSkinVertices(59, 52, 62, 64)\r\n\t\t\t);\r\n\t\t} else {\r\n\t\t\taddVertices(leftArm2Box,\r\n\t\t\t\ttoSkinVertices(52, 48, 56, 52),\r\n\t\t\t\ttoSkinVertices(56, 48, 60, 52),\r\n\t\t\t\ttoSkinVertices(48, 52, 52, 64),\r\n\t\t\t\ttoSkinVertices(52, 52, 56, 64),\r\n\t\t\t\ttoSkinVertices(56, 52, 60, 64),\r\n\t\t\t\ttoSkinVertices(60, 52, 64, 64)\r\n\t\t\t);\r\n\t\t}\r\n\t\tlet leftArm2Mesh = new THREE.Mesh(leftArm2Box, layer2Material);\r\n\t\tleftArm2Mesh.renderOrder = 1;\r\n\t\tleftArmPivot.add(leftArm2Mesh);\r\n\r\n\t\tleftArmPivot.position.y = -6;\r\n\t\tthis.leftArm.add(leftArmPivot);\r\n\t\tthis.leftArm.position.y = -4;\r\n\t\tthis.leftArm.position.x = isSlim ? 5.5 : 6;\r\n\t\tthis.add(this.leftArm);\r\n\r\n\r\n\t\t// Right Leg\r\n\t\tthis.rightLeg = new THREE.Group();\r\n\t\tlet rightLegPivot = new THREE.Group();\r\n\r\n\t\tlet rightLegBox = new THREE.BoxGeometry(4 - esp, 12 - esp, 4 - esp, 0, 0, 0);\r\n\t\taddVertices(rightLegBox,\r\n\t\t\ttoSkinVertices(4, 16, 8, 20),\r\n\t\t\ttoSkinVertices(8, 16, 12, 20),\r\n\t\t\ttoSkinVertices(0, 20, 4, 32),\r\n\t\t\ttoSkinVertices(4, 20, 8, 32),\r\n\t\t\ttoSkinVertices(8, 20, 12, 32),\r\n\t\t\ttoSkinVertices(12, 20, 16, 32)\r\n\t\t);\r\n\t\tlet rightLegMesh = new THREE.Mesh(rightLegBox, layer1Material);\r\n\t\trightLegPivot.add(rightLegMesh);\r\n\r\n\t\tlet rightLeg2Box = new THREE.BoxGeometry(4.5 - esp, 13.5 - esp, 4.5 - esp, 0, 0, 0);\r\n\t\taddVertices(rightLeg2Box,\r\n\t\t\ttoSkinVertices(4, 32, 8, 36),\r\n\t\t\ttoSkinVertices(8, 32, 12, 36),\r\n\t\t\ttoSkinVertices(0, 36, 4, 48),\r\n\t\t\ttoSkinVertices(4, 36, 8, 48),\r\n\t\t\ttoSkinVertices(8, 36, 12, 48),\r\n\t\t\ttoSkinVertices(12, 36, 16, 48)\r\n\t\t);\r\n\t\tlet rightLeg2Mesh = new THREE.Mesh(rightLeg2Box, layer2Material);\r\n\t\trightLeg2Mesh.renderOrder = 1;\r\n\t\trightLegPivot.add(rightLeg2Mesh);\r\n\r\n\t\trightLegPivot.position.y = -6;\r\n\t\tthis.rightLeg.add(rightLegPivot);\r\n\t\tthis.rightLeg.position.y = -16;\r\n\t\tthis.rightLeg.position.x = -2;\r\n\t\tthis.add(this.rightLeg);\r\n\r\n\t\t// Left Leg\r\n\t\tthis.leftLeg = new THREE.Group();\r\n\t\tlet leftLegPivot = new THREE.Group();\r\n\r\n\t\tlet leftLegBox = new THREE.BoxGeometry(4 - esp, 12 - esp, 4 - esp, 0, 0, 0);\r\n\t\taddVertices(leftLegBox,\r\n\t\t\ttoSkinVertices(20, 48, 24, 52),\r\n\t\t\ttoSkinVertices(24, 48, 28, 52),\r\n\t\t\ttoSkinVertices(16, 52, 20, 64),\r\n\t\t\ttoSkinVertices(20, 52, 24, 64),\r\n\t\t\ttoSkinVertices(24, 52, 28, 64),\r\n\t\t\ttoSkinVertices(28, 52, 32, 64)\r\n\t\t);\r\n\t\tlet leftLegMesh = new THREE.Mesh(leftLegBox, layer1Material);\r\n\t\tleftLegPivot.add(leftLegMesh);\r\n\r\n\t\tlet leftLeg2Box = new THREE.BoxGeometry(4.5 - esp, 13.5 - esp, 4.5 - esp, 0, 0, 0);\r\n\t\taddVertices(leftLeg2Box,\r\n\t\t\ttoSkinVertices(4, 48, 8, 52),\r\n\t\t\ttoSkinVertices(8, 48, 12, 52),\r\n\t\t\ttoSkinVertices(0, 52, 4, 64),\r\n\t\t\ttoSkinVertices(4, 52, 8, 64),\r\n\t\t\ttoSkinVertices(8, 52, 12, 64),\r\n\t\t\ttoSkinVertices(12, 52, 16, 64)\r\n\t\t);\r\n\t\tlet leftLeg2Mesh = new THREE.Mesh(leftLeg2Box, layer2Material);\r\n\t\tleftLeg2Mesh.renderOrder = 1;\r\n\t\tleftLegPivot.add(leftLeg2Mesh);\r\n\r\n\t\tleftLegPivot.position.y = -6;\r\n\t\tthis.leftLeg.add(leftLegPivot);\r\n\t\tthis.leftLeg.position.y = -16;\r\n\t\tthis.leftLeg.position.x = 2;\r\n\t\tthis.add(this.leftLeg);\r\n\t}\r\n}\r\n\r\nclass CapeObject extends THREE.Group {\r\n\tconstructor(capeMaterial) {\r\n\t\tsuper();\r\n\r\n\t\t// back = outside\r\n\t\t// front = inside\r\n\t\tlet capeBox = new THREE.BoxGeometry(10, 16, 1, 0, 0, 0);\r\n\t\taddVertices(capeBox,\r\n\t\t\ttoCapeVertices(1, 0, 11, 1),\r\n\t\t\ttoCapeVertices(11, 0, 21, 1),\r\n\t\t\ttoCapeVertices(11, 1, 12, 17),\r\n\t\t\ttoCapeVertices(12, 1, 22, 17),\r\n\t\t\ttoCapeVertices(0, 1, 1, 17),\r\n\t\t\ttoCapeVertices(1, 1, 11, 17)\r\n\t\t);\r\n\t\tthis.cape = new THREE.Mesh(capeBox, capeMaterial);\r\n\t\tthis.cape.position.y = -8;\r\n\t\tthis.cape.position.z = -0.5;\r\n\t\tthis.add(this.cape);\r\n\t}\r\n}\r\n\r\nclass PlayerObject extends THREE.Group {\r\n\tconstructor(slim, layer1Material, layer2Material, capeMaterial) {\r\n\t\tsuper();\r\n\r\n\t\tthis.slim = slim;\r\n\r\n\t\tthis.skin = new SkinObject(slim, layer1Material, layer2Material);\r\n\t\tthis.skin.visible = false;\r\n\t\tthis.add(this.skin);\r\n\r\n\t\tthis.cape = new CapeObject(capeMaterial);\r\n\t\tthis.cape.position.z = -2;\r\n\t\tthis.cape.position.y = -4;\r\n\t\tthis.cape.rotation.x = 25 * Math.PI / 180;\r\n\t\tthis.cape.visible = false;\r\n\t\tthis.add(this.cape);\r\n\t}\r\n}\r\n\r\nexport { SkinObject, CapeObject, PlayerObject };\r\n","import * as THREE from \"three\";\r\n\r\nclass OrbitControls extends THREE.EventDispatcher {\r\n\t/**\r\n\t * @preserve\r\n\t * The code was originally from https://github.com/mrdoob/three.js/blob/d45a042cf962e9b1aa9441810ba118647b48aacb/examples/js/controls/OrbitControls.js\r\n\t */\r\n\t/**\r\n\t * @license\r\n\t * Copyright (C) 2010-2017 three.js authors\r\n\t *\r\n\t * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n\t * of this software and associated documentation files (the \"Software\"), to deal\r\n\t * in the Software without restriction, including without limitation the rights\r\n\t * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n\t * copies of the Software, and to permit persons to whom the Software is\r\n\t * furnished to do so, subject to the following conditions:\r\n\t *\r\n\t * The above copyright notice and this permission notice shall be included in\r\n\t * all copies or substantial portions of the Software.\r\n\t *\r\n\t * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n\t * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n\t * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n\t * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n\t * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n\t * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n\t * THE SOFTWARE.\r\n\t *\r\n\t *\r\n\t * @author qiao / https://github.com/qiao\r\n\t * @author mrdoob / http://mrdoob.com\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t * @author erich666 / http://erichaines.com\r\n\t */\r\n\r\n\t// This set of controls performs orbiting, dollying (zooming), and panning.\r\n\t// Unlike TrackballControls, it maintains the \"up\" direction object.up (+Y by default).\r\n\t//\r\n\t//    Orbit - left mouse / touch: one finger move\r\n\t//    Zoom - middle mouse, or mousewheel / touch: two finger spread or squish\r\n\t//    Pan - right mouse, or arrow keys / touch: three finger swipe\r\n\r\n\tconstructor(object, domElement) {\r\n\t\tsuper();\r\n\t\tthis.object = object;\r\n\t\tthis.domElement = (domElement !== undefined) ? domElement : document;\r\n\r\n\t\t// Set to false to disable this control\r\n\t\tthis.enabled = true;\r\n\r\n\t\t// \"target\" sets the location of focus, where the object orbits around\r\n\t\tthis.target = new THREE.Vector3();\r\n\r\n\t\t// How far you can dolly in and out (PerspectiveCamera only)\r\n\t\tthis.minDistance = 0;\r\n\t\tthis.maxDistance = Infinity;\r\n\r\n\t\t// How far you can zoom in and out (OrthographicCamera only)\r\n\t\tthis.minZoom = 0;\r\n\t\tthis.maxZoom = Infinity;\r\n\r\n\t\t// How far you can orbit vertically, upper and lower limits.\r\n\t\t// Range is 0 to Math.PI radians.\r\n\t\tthis.minPolarAngle = 0; // radians\r\n\t\tthis.maxPolarAngle = Math.PI; // radians\r\n\r\n\t\t// How far you can orbit horizontally, upper and lower limits.\r\n\t\t// If set, must be a sub-interval of the interval [ - Math.PI, Math.PI ].\r\n\t\tthis.minAzimuthAngle = -Infinity; // radians\r\n\t\tthis.maxAzimuthAngle = Infinity; // radians\r\n\r\n\t\t// Set to true to enable damping (inertia)\r\n\t\t// If damping is enabled, you must call controls.update() in your animation loop\r\n\t\tthis.enableDamping = false;\r\n\t\tthis.dampingFactor = 0.25;\r\n\r\n\t\t// This option actually enables dollying in and out; left as \"zoom\" for backwards compatibility.\r\n\t\t// Set to false to disable zooming\r\n\t\tthis.enableZoom = true;\r\n\t\tthis.zoomSpeed = 1.0;\r\n\r\n\t\t// Set to false to disable rotating\r\n\t\tthis.enableRotate = true;\r\n\t\tthis.rotateSpeed = 1.0;\r\n\r\n\t\t// Set to false to disable panning\r\n\t\tthis.enablePan = true;\r\n\t\tthis.keyPanSpeed = 7.0; // pixels moved per arrow key push\r\n\r\n\t\t// Set to true to automatically rotate around the target\r\n\t\t// If auto-rotate is enabled, you must call controls.update() in your animation loop\r\n\t\tthis.autoRotate = false;\r\n\t\tthis.autoRotateSpeed = 2.0; // 30 seconds per round when fps is 60\r\n\r\n\t\t// Set to false to disable use of the keys\r\n\t\tthis.enableKeys = true;\r\n\r\n\t\t// The four arrow keys\r\n\t\tthis.keys = { LEFT: 37, UP: 38, RIGHT: 39, BOTTOM: 40 };\r\n\r\n\t\t// Mouse buttons\r\n\t\tthis.mouseButtons = { ORBIT: THREE.MOUSE.LEFT, ZOOM: THREE.MOUSE.MIDDLE, PAN: THREE.MOUSE.RIGHT };\r\n\r\n\t\t// for reset\r\n\t\tthis.target0 = this.target.clone();\r\n\t\tthis.position0 = this.object.position.clone();\r\n\t\tthis.zoom0 = this.object.zoom;\r\n\r\n\t\t//\r\n\t\t// public methods\r\n\t\t//\r\n\t\tthis.getPolarAngle = function () {\r\n\t\t\treturn spherical.phi;\r\n\t\t};\r\n\t\tthis.getAzimuthalAngle = function () {\r\n\t\t\treturn spherical.theta;\r\n\t\t};\r\n\t\tthis.saveState = function () {\r\n\t\t\tscope.target0.copy(scope.target);\r\n\t\t\tscope.position0.copy(scope.object.position);\r\n\t\t\tscope.zoom0 = scope.object.zoom;\r\n\t\t};\r\n\t\tthis.reset = function () {\r\n\t\t\tscope.target.copy(scope.target0);\r\n\t\t\tscope.object.position.copy(scope.position0);\r\n\t\t\tscope.object.zoom = scope.zoom0;\r\n\t\t\tscope.object.updateProjectionMatrix();\r\n\t\t\tscope.dispatchEvent(changeEvent);\r\n\t\t\tscope.update();\r\n\t\t\tstate = STATE.NONE;\r\n\t\t};\r\n\r\n\t\t// this method is exposed, but perhaps it would be better if we can make it private...\r\n\t\tthis.update = function () {\r\n\t\t\tlet offset = new THREE.Vector3();\r\n\t\t\t// so camera.up is the orbit axis\r\n\t\t\tlet quat = new THREE.Quaternion().setFromUnitVectors(object.up, new THREE.Vector3(0, 1, 0));\r\n\t\t\tlet quatInverse = quat.clone().inverse();\r\n\t\t\tlet lastPosition = new THREE.Vector3();\r\n\t\t\tlet lastQuaternion = new THREE.Quaternion();\r\n\t\t\treturn function update() {\r\n\t\t\t\tlet position = scope.object.position;\r\n\t\t\t\toffset.copy(position).sub(scope.target);\r\n\t\t\t\t// rotate offset to \"y-axis-is-up\" space\r\n\t\t\t\toffset.applyQuaternion(quat);\r\n\t\t\t\t// angle from z-axis around y-axis\r\n\t\t\t\tspherical.setFromVector3(offset);\r\n\t\t\t\tif (scope.autoRotate && state === STATE.NONE) {\r\n\t\t\t\t\trotateLeft(getAutoRotationAngle());\r\n\t\t\t\t}\r\n\t\t\t\tspherical.theta += sphericalDelta.theta;\r\n\t\t\t\tspherical.phi += sphericalDelta.phi;\r\n\t\t\t\t// restrict theta to be between desired limits\r\n\t\t\t\tspherical.theta = Math.max(scope.minAzimuthAngle, Math.min(scope.maxAzimuthAngle, spherical.theta));\r\n\t\t\t\t// restrict phi to be between desired limits\r\n\t\t\t\tspherical.phi = Math.max(scope.minPolarAngle, Math.min(scope.maxPolarAngle, spherical.phi));\r\n\t\t\t\tspherical.makeSafe();\r\n\t\t\t\tspherical.radius *= scale;\r\n\t\t\t\t// restrict radius to be between desired limits\r\n\t\t\t\tspherical.radius = Math.max(scope.minDistance, Math.min(scope.maxDistance, spherical.radius));\r\n\t\t\t\t// move target to panned location\r\n\t\t\t\tscope.target.add(panOffset);\r\n\t\t\t\toffset.setFromSpherical(spherical);\r\n\t\t\t\t// rotate offset back to \"camera-up-vector-is-up\" space\r\n\t\t\t\toffset.applyQuaternion(quatInverse);\r\n\t\t\t\tposition.copy(scope.target).add(offset);\r\n\t\t\t\tscope.object.lookAt(scope.target);\r\n\t\t\t\tif (scope.enableDamping === true) {\r\n\t\t\t\t\tsphericalDelta.theta *= (1 - scope.dampingFactor);\r\n\t\t\t\t\tsphericalDelta.phi *= (1 - scope.dampingFactor);\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tsphericalDelta.set(0, 0, 0);\r\n\t\t\t\t}\r\n\t\t\t\tscale = 1;\r\n\t\t\t\tpanOffset.set(0, 0, 0);\r\n\t\t\t\t// update condition is:\r\n\t\t\t\t// min(camera displacement, camera rotation in radians)^2 > EPS\r\n\t\t\t\t// using small-angle approximation cos(x/2) = 1 - x^2 / 8\r\n\t\t\t\tif (zoomChanged ||\r\n\t\t\t\t\tlastPosition.distanceToSquared(scope.object.position) > EPS ||\r\n\t\t\t\t\t8 * (1 - lastQuaternion.dot(scope.object.quaternion)) > EPS) {\r\n\t\t\t\t\tscope.dispatchEvent(changeEvent);\r\n\t\t\t\t\tlastPosition.copy(scope.object.position);\r\n\t\t\t\t\tlastQuaternion.copy(scope.object.quaternion);\r\n\t\t\t\t\tzoomChanged = false;\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t};\r\n\t\t}();\r\n\t\tthis.dispose = function () {\r\n\t\t\tscope.domElement.removeEventListener(\"contextmenu\", onContextMenu, false);\r\n\t\t\tscope.domElement.removeEventListener(\"mousedown\", onMouseDown, false);\r\n\t\t\tscope.domElement.removeEventListener(\"wheel\", onMouseWheel, false);\r\n\t\t\tscope.domElement.removeEventListener(\"touchstart\", onTouchStart, false);\r\n\t\t\tscope.domElement.removeEventListener(\"touchend\", onTouchEnd, false);\r\n\t\t\tscope.domElement.removeEventListener(\"touchmove\", onTouchMove, false);\r\n\t\t\tdocument.removeEventListener(\"mousemove\", onMouseMove, false);\r\n\t\t\tdocument.removeEventListener(\"mouseup\", onMouseUp, false);\r\n\t\t\twindow.removeEventListener(\"keydown\", onKeyDown, false);\r\n\t\t\t//scope.dispatchEvent({ type: \"dispose\" }); // should this be added here?\r\n\t\t};\r\n\t\t//\r\n\t\t// internals\r\n\t\t//\r\n\t\tlet scope = this;\r\n\t\tlet changeEvent = { type: \"change\" };\r\n\t\tlet startEvent = { type: \"start\" };\r\n\t\tlet endEvent = { type: \"end\" };\r\n\t\tlet STATE = { NONE: -1, ROTATE: 0, DOLLY: 1, PAN: 2, TOUCH_ROTATE: 3, TOUCH_DOLLY: 4, TOUCH_PAN: 5 };\r\n\t\tlet state = STATE.NONE;\r\n\t\tlet EPS = 0.000001;\r\n\t\t// current position in spherical coordinates\r\n\t\tlet spherical = new THREE.Spherical();\r\n\t\tlet sphericalDelta = new THREE.Spherical();\r\n\t\tlet scale = 1;\r\n\t\tlet panOffset = new THREE.Vector3();\r\n\t\tlet zoomChanged = false;\r\n\t\tlet rotateStart = new THREE.Vector2();\r\n\t\tlet rotateEnd = new THREE.Vector2();\r\n\t\tlet rotateDelta = new THREE.Vector2();\r\n\t\tlet panStart = new THREE.Vector2();\r\n\t\tlet panEnd = new THREE.Vector2();\r\n\t\tlet panDelta = new THREE.Vector2();\r\n\t\tlet dollyStart = new THREE.Vector2();\r\n\t\tlet dollyEnd = new THREE.Vector2();\r\n\t\tlet dollyDelta = new THREE.Vector2();\r\n\t\tfunction getAutoRotationAngle() {\r\n\t\t\treturn 2 * Math.PI / 60 / 60 * scope.autoRotateSpeed;\r\n\t\t}\r\n\t\tfunction getZoomScale() {\r\n\t\t\treturn Math.pow(0.95, scope.zoomSpeed);\r\n\t\t}\r\n\t\tfunction rotateLeft(angle) {\r\n\t\t\tsphericalDelta.theta -= angle;\r\n\t\t}\r\n\t\tfunction rotateUp(angle) {\r\n\t\t\tsphericalDelta.phi -= angle;\r\n\t\t}\r\n\t\tlet panLeft = function () {\r\n\t\t\tlet v = new THREE.Vector3();\r\n\t\t\treturn function panLeft(distance, objectMatrix) {\r\n\t\t\t\tv.setFromMatrixColumn(objectMatrix, 0); // get X column of objectMatrix\r\n\t\t\t\tv.multiplyScalar(-distance);\r\n\t\t\t\tpanOffset.add(v);\r\n\t\t\t};\r\n\t\t}();\r\n\t\tlet panUp = function () {\r\n\t\t\tlet v = new THREE.Vector3();\r\n\t\t\treturn function panUp(distance, objectMatrix) {\r\n\t\t\t\tv.setFromMatrixColumn(objectMatrix, 1); // get Y column of objectMatrix\r\n\t\t\t\tv.multiplyScalar(distance);\r\n\t\t\t\tpanOffset.add(v);\r\n\t\t\t};\r\n\t\t}();\r\n\t\t// deltaX and deltaY are in pixels; right and down are positive\r\n\t\tlet pan = function () {\r\n\t\t\tlet offset = new THREE.Vector3();\r\n\t\t\treturn function pan(deltaX, deltaY) {\r\n\t\t\t\tlet element = scope.domElement === document ? scope.domElement.body : scope.domElement;\r\n\t\t\t\tif (scope.object instanceof THREE.PerspectiveCamera) {\r\n\t\t\t\t\t// perspective\r\n\t\t\t\t\tlet position = scope.object.position;\r\n\t\t\t\t\toffset.copy(position).sub(scope.target);\r\n\t\t\t\t\tlet targetDistance = offset.length();\r\n\t\t\t\t\t// half of the fov is center to top of screen\r\n\t\t\t\t\ttargetDistance *= Math.tan((scope.object.fov / 2) * Math.PI / 180.0);\r\n\t\t\t\t\t// we actually don't use screenWidth, since perspective camera is fixed to screen height\r\n\t\t\t\t\tpanLeft(2 * deltaX * targetDistance / element.clientHeight, scope.object.matrix);\r\n\t\t\t\t\tpanUp(2 * deltaY * targetDistance / element.clientHeight, scope.object.matrix);\r\n\t\t\t\t}\r\n\t\t\t\telse if (scope.object instanceof THREE.OrthographicCamera) {\r\n\t\t\t\t\t// orthographic\r\n\t\t\t\t\tpanLeft(deltaX * (scope.object.right - scope.object.left) / scope.object.zoom / element.clientWidth, scope.object.matrix);\r\n\t\t\t\t\tpanUp(deltaY * (scope.object.top - scope.object.bottom) / scope.object.zoom / element.clientHeight, scope.object.matrix);\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\t// camera neither orthographic nor perspective\r\n\t\t\t\t\tconsole.warn(\"WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.\");\r\n\t\t\t\t\tscope.enablePan = false;\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}();\r\n\t\tfunction dollyIn(dollyScale) {\r\n\t\t\tif (scope.object instanceof THREE.PerspectiveCamera) {\r\n\t\t\t\tscale /= dollyScale;\r\n\t\t\t}\r\n\t\t\telse if (scope.object instanceof THREE.OrthographicCamera) {\r\n\t\t\t\tscope.object.zoom = Math.max(scope.minZoom, Math.min(scope.maxZoom, scope.object.zoom * dollyScale));\r\n\t\t\t\tscope.object.updateProjectionMatrix();\r\n\t\t\t\tzoomChanged = true;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tconsole.warn(\"WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.\");\r\n\t\t\t\tscope.enableZoom = false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tfunction dollyOut(dollyScale) {\r\n\t\t\tif (scope.object instanceof THREE.PerspectiveCamera) {\r\n\t\t\t\tscale *= dollyScale;\r\n\t\t\t}\r\n\t\t\telse if (scope.object instanceof THREE.OrthographicCamera) {\r\n\t\t\t\tscope.object.zoom = Math.max(scope.minZoom, Math.min(scope.maxZoom, scope.object.zoom / dollyScale));\r\n\t\t\t\tscope.object.updateProjectionMatrix();\r\n\t\t\t\tzoomChanged = true;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tconsole.warn(\"WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.\");\r\n\t\t\t\tscope.enableZoom = false;\r\n\t\t\t}\r\n\t\t}\r\n\t\t//\r\n\t\t// event callbacks - update the object state\r\n\t\t//\r\n\t\tfunction handleMouseDownRotate(event) {\r\n\t\t\trotateStart.set(event.clientX, event.clientY);\r\n\t\t}\r\n\t\tfunction handleMouseDownDolly(event) {\r\n\t\t\tdollyStart.set(event.clientX, event.clientY);\r\n\t\t}\r\n\t\tfunction handleMouseDownPan(event) {\r\n\t\t\tpanStart.set(event.clientX, event.clientY);\r\n\t\t}\r\n\t\tfunction handleMouseMoveRotate(event) {\r\n\t\t\trotateEnd.set(event.clientX, event.clientY);\r\n\t\t\trotateDelta.subVectors(rotateEnd, rotateStart);\r\n\t\t\tlet element = scope.domElement === document ? scope.domElement.body : scope.domElement;\r\n\t\t\t// rotating across whole screen goes 360 degrees around\r\n\t\t\trotateLeft(2 * Math.PI * rotateDelta.x / element.clientWidth * scope.rotateSpeed);\r\n\t\t\t// rotating up and down along whole screen attempts to go 360, but limited to 180\r\n\t\t\trotateUp(2 * Math.PI * rotateDelta.y / element.clientHeight * scope.rotateSpeed);\r\n\t\t\trotateStart.copy(rotateEnd);\r\n\t\t\tscope.update();\r\n\t\t}\r\n\t\tfunction handleMouseMoveDolly(event) {\r\n\t\t\tdollyEnd.set(event.clientX, event.clientY);\r\n\t\t\tdollyDelta.subVectors(dollyEnd, dollyStart);\r\n\t\t\tif (dollyDelta.y > 0) {\r\n\t\t\t\tdollyIn(getZoomScale());\r\n\t\t\t}\r\n\t\t\telse if (dollyDelta.y < 0) {\r\n\t\t\t\tdollyOut(getZoomScale());\r\n\t\t\t}\r\n\t\t\tdollyStart.copy(dollyEnd);\r\n\t\t\tscope.update();\r\n\t\t}\r\n\t\tfunction handleMouseMovePan(event) {\r\n\t\t\tpanEnd.set(event.clientX, event.clientY);\r\n\t\t\tpanDelta.subVectors(panEnd, panStart);\r\n\t\t\tpan(panDelta.x, panDelta.y);\r\n\t\t\tpanStart.copy(panEnd);\r\n\t\t\tscope.update();\r\n\t\t}\r\n\t\tfunction handleMouseUp(event) {\r\n\t\t}\r\n\t\tfunction handleMouseWheel(event) {\r\n\t\t\tif (event.deltaY < 0) {\r\n\t\t\t\tdollyOut(getZoomScale());\r\n\t\t\t}\r\n\t\t\telse if (event.deltaY > 0) {\r\n\t\t\t\tdollyIn(getZoomScale());\r\n\t\t\t}\r\n\t\t\tscope.update();\r\n\t\t}\r\n\t\tfunction handleKeyDown(event) {\r\n\t\t\tswitch (event.keyCode) {\r\n\t\t\t\tcase scope.keys.UP:\r\n\t\t\t\t\tpan(0, scope.keyPanSpeed);\r\n\t\t\t\t\tscope.update();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase scope.keys.BOTTOM:\r\n\t\t\t\t\tpan(0, -scope.keyPanSpeed);\r\n\t\t\t\t\tscope.update();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase scope.keys.LEFT:\r\n\t\t\t\t\tpan(scope.keyPanSpeed, 0);\r\n\t\t\t\t\tscope.update();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase scope.keys.RIGHT:\r\n\t\t\t\t\tpan(-scope.keyPanSpeed, 0);\r\n\t\t\t\t\tscope.update();\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tfunction handleTouchStartRotate(event) {\r\n\t\t\trotateStart.set(event.touches[0].pageX, event.touches[0].pageY);\r\n\t\t}\r\n\t\tfunction handleTouchStartDolly(event) {\r\n\t\t\tlet dx = event.touches[0].pageX - event.touches[1].pageX;\r\n\t\t\tlet dy = event.touches[0].pageY - event.touches[1].pageY;\r\n\t\t\tlet distance = Math.sqrt(dx * dx + dy * dy);\r\n\t\t\tdollyStart.set(0, distance);\r\n\t\t}\r\n\t\tfunction handleTouchStartPan(event) {\r\n\t\t\tpanStart.set(event.touches[0].pageX, event.touches[0].pageY);\r\n\t\t}\r\n\t\tfunction handleTouchMoveRotate(event) {\r\n\t\t\trotateEnd.set(event.touches[0].pageX, event.touches[0].pageY);\r\n\t\t\trotateDelta.subVectors(rotateEnd, rotateStart);\r\n\t\t\tlet element = scope.domElement === document ? scope.domElement.body : scope.domElement;\r\n\t\t\trotateLeft(2 * Math.PI * rotateDelta.x / element.clientWidth * scope.rotateSpeed);\r\n\t\t\trotateUp(2 * Math.PI * rotateDelta.y / element.clientHeight * scope.rotateSpeed);\r\n\t\t\trotateStart.copy(rotateEnd);\r\n\t\t\tscope.update();\r\n\t\t}\r\n\t\tfunction handleTouchMoveDolly(event) {\r\n\t\t\tlet dx = event.touches[0].pageX - event.touches[1].pageX;\r\n\t\t\tlet dy = event.touches[0].pageY - event.touches[1].pageY;\r\n\t\t\tlet distance = Math.sqrt(dx * dx + dy * dy);\r\n\t\t\tdollyEnd.set(0, distance);\r\n\t\t\tdollyDelta.subVectors(dollyEnd, dollyStart);\r\n\t\t\tif (dollyDelta.y > 0) {\r\n\t\t\t\tdollyOut(getZoomScale());\r\n\t\t\t}\r\n\t\t\telse if (dollyDelta.y < 0) {\r\n\t\t\t\tdollyIn(getZoomScale());\r\n\t\t\t}\r\n\t\t\tdollyStart.copy(dollyEnd);\r\n\t\t\tscope.update();\r\n\t\t}\r\n\t\tfunction handleTouchMovePan(event) {\r\n\t\t\tpanEnd.set(event.touches[0].pageX, event.touches[0].pageY);\r\n\t\t\tpanDelta.subVectors(panEnd, panStart);\r\n\t\t\tpan(panDelta.x, panDelta.y);\r\n\t\t\tpanStart.copy(panEnd);\r\n\t\t\tscope.update();\r\n\t\t}\r\n\t\tfunction handleTouchEnd(event) {\r\n\t\t}\r\n\t\t//\r\n\t\t// event handlers - FSM: listen for events and reset state\r\n\t\t//\r\n\t\tfunction onMouseDown(event) {\r\n\t\t\tif (scope.enabled === false)\r\n\t\t\t\treturn;\r\n\t\t\tswitch (event.button) {\r\n\t\t\t\tcase scope.mouseButtons.ORBIT:\r\n\t\t\t\t\tif (scope.enableRotate === false)\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\thandleMouseDownRotate(event);\r\n\t\t\t\t\tstate = STATE.ROTATE;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase scope.mouseButtons.ZOOM:\r\n\t\t\t\t\tif (scope.enableZoom === false)\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\thandleMouseDownDolly(event);\r\n\t\t\t\t\tstate = STATE.DOLLY;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase scope.mouseButtons.PAN:\r\n\t\t\t\t\tif (scope.enablePan === false)\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\thandleMouseDownPan(event);\r\n\t\t\t\t\tstate = STATE.PAN;\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tevent.preventDefault();\r\n\t\t\tif (state !== STATE.NONE) {\r\n\t\t\t\tdocument.addEventListener(\"mousemove\", onMouseMove, false);\r\n\t\t\t\tdocument.addEventListener(\"mouseup\", onMouseUp, false);\r\n\t\t\t\tscope.dispatchEvent(startEvent);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfunction onMouseMove(event) {\r\n\t\t\tif (scope.enabled === false)\r\n\t\t\t\treturn;\r\n\t\t\tswitch (state) {\r\n\t\t\t\tcase STATE.ROTATE:\r\n\t\t\t\t\tif (scope.enableRotate === false)\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\thandleMouseMoveRotate(event);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase STATE.DOLLY:\r\n\t\t\t\t\tif (scope.enableZoom === false)\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\thandleMouseMoveDolly(event);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase STATE.PAN:\r\n\t\t\t\t\tif (scope.enablePan === false)\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\thandleMouseMovePan(event);\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tevent.preventDefault();\r\n\t\t}\r\n\t\tfunction onMouseUp(event) {\r\n\t\t\tif (scope.enabled === false)\r\n\t\t\t\treturn;\r\n\t\t\thandleMouseUp(event);\r\n\t\t\tdocument.removeEventListener(\"mousemove\", onMouseMove, false);\r\n\t\t\tdocument.removeEventListener(\"mouseup\", onMouseUp, false);\r\n\t\t\tscope.dispatchEvent(endEvent);\r\n\t\t\tstate = STATE.NONE;\r\n\t\t}\r\n\t\tfunction onMouseWheel(event) {\r\n\t\t\tif (scope.enabled === false || scope.enableZoom === false || (state !== STATE.NONE && state !== STATE.ROTATE))\r\n\t\t\t\treturn;\r\n\t\t\tevent.preventDefault();\r\n\t\t\tevent.stopPropagation();\r\n\t\t\thandleMouseWheel(event);\r\n\t\t\tscope.dispatchEvent(startEvent); // not sure why these are here...\r\n\t\t\tscope.dispatchEvent(endEvent);\r\n\t\t}\r\n\t\tfunction onKeyDown(event) {\r\n\t\t\tif (scope.enabled === false || scope.enableKeys === false || scope.enablePan === false)\r\n\t\t\t\treturn;\r\n\t\t\thandleKeyDown(event);\r\n\t\t}\r\n\t\tfunction onTouchStart(event) {\r\n\t\t\tif (scope.enabled === false)\r\n\t\t\t\treturn;\r\n\t\t\tswitch (event.touches.length) {\r\n\t\t\t\tcase 1:// one-fingered touch: rotate\r\n\t\t\t\t\tif (scope.enableRotate === false)\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\thandleTouchStartRotate(event);\r\n\t\t\t\t\tstate = STATE.TOUCH_ROTATE;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 2:// two-fingered touch: dolly\r\n\t\t\t\t\tif (scope.enableZoom === false)\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\thandleTouchStartDolly(event);\r\n\t\t\t\t\tstate = STATE.TOUCH_DOLLY;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 3:// three-fingered touch: pan\r\n\t\t\t\t\tif (scope.enablePan === false)\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\thandleTouchStartPan(event);\r\n\t\t\t\t\tstate = STATE.TOUCH_PAN;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tstate = STATE.NONE;\r\n\t\t\t}\r\n\t\t\tif (state !== STATE.NONE) {\r\n\t\t\t\tscope.dispatchEvent(startEvent);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfunction onTouchMove(event) {\r\n\t\t\tif (scope.enabled === false)\r\n\t\t\t\treturn;\r\n\t\t\tswitch (event.touches.length) {\r\n\t\t\t\tcase 1:// one-fingered touch: rotate\r\n\t\t\t\t\tif (scope.enableRotate === false)\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\tif (state !== STATE.TOUCH_ROTATE)\r\n\t\t\t\t\t\treturn; // is this needed?...\r\n\t\t\t\t\thandleTouchMoveRotate(event);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 2:// two-fingered touch: dolly\r\n\t\t\t\t\tif (scope.enableZoom === false)\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\tif (state !== STATE.TOUCH_DOLLY)\r\n\t\t\t\t\t\treturn; // is this needed?...\r\n\t\t\t\t\thandleTouchMoveDolly(event);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 3:// three-fingered touch: pan\r\n\t\t\t\t\tif (scope.enablePan === false)\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\tif (state !== STATE.TOUCH_PAN)\r\n\t\t\t\t\t\treturn; // is this needed?...\r\n\t\t\t\t\thandleTouchMovePan(event);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tstate = STATE.NONE;\r\n\t\t\t}\r\n\t\t\tevent.preventDefault();\r\n\t\t\tevent.stopPropagation();\r\n\t\t}\r\n\t\tfunction onTouchEnd(event) {\r\n\t\t\tif (scope.enabled === false)\r\n\t\t\t\treturn;\r\n\t\t\thandleTouchEnd(event);\r\n\t\t\tscope.dispatchEvent(endEvent);\r\n\t\t\tstate = STATE.NONE;\r\n\t\t}\r\n\t\tfunction onContextMenu(event) {\r\n\t\t\tif (scope.enabled === false || scope.enablePan === false)\r\n\t\t\t\treturn;\r\n\t\t\tevent.preventDefault();\r\n\t\t}\r\n\t\t//\r\n\t\tscope.domElement.addEventListener(\"contextmenu\", onContextMenu, false);\r\n\t\tscope.domElement.addEventListener(\"mousedown\", onMouseDown, false);\r\n\t\tscope.domElement.addEventListener(\"wheel\", onMouseWheel, false);\r\n\t\tscope.domElement.addEventListener(\"touchstart\", onTouchStart, false);\r\n\t\tscope.domElement.addEventListener(\"touchend\", onTouchEnd, false);\r\n\t\tscope.domElement.addEventListener(\"touchmove\", onTouchMove, false);\r\n\t\twindow.addEventListener(\"keydown\", onKeyDown, false);\r\n\t\t// force an update at start\r\n\t\tthis.update();\r\n\t}\r\n}\r\n\r\nexport { OrbitControls };\r\n","function invokeAnimation(animation, player, time) {\r\n\tif (animation instanceof CompositeAnimation) {\r\n\t\tanimation.play(player, time);\r\n\t} else if (animation instanceof Function) {\r\n\t\tanimation(player, time);\r\n\t} else {\r\n\t\tthrow `Not an animation: ${animation}`;\r\n\t}\r\n}\r\n\r\nclass AnimationHandle {\r\n\tconstructor(animation) {\r\n\t\tthis.animation = animation;\r\n\t\tthis.paused = this._paused = false;\r\n\t\tthis.speed = this._speed = 1.0;\r\n\t\tthis._lastChange = null;\r\n\t\tthis._lastChangeX = null;\r\n\t}\r\n\tplay(player, time) {\r\n\t\tif (this._lastChange === null) {\r\n\t\t\tthis._lastChange = time;\r\n\t\t\tthis._lastChangeX = 0;\r\n\t\t} else if (this.paused !== this._paused || this.speed !== this._speed) {\r\n\t\t\tlet dt = time - this._lastChange;\r\n\t\t\tif (this._paused === false) {\r\n\t\t\t\tthis._lastChangeX += dt * this._speed;\r\n\t\t\t}\r\n\t\t\tthis._paused = this.paused;\r\n\t\t\tthis._speed = this.speed;\r\n\t\t\tthis._lastChange = time;\r\n\t\t}\r\n\t\tif (this.paused === false) {\r\n\t\t\tlet dt = time - this._lastChange;\r\n\t\t\tlet x = this._lastChangeX + this.speed * dt;\r\n\t\t\tinvokeAnimation(this.animation, player, x);\r\n\t\t}\r\n\t}\r\n\treset(){\r\n\t\tthis._lastChange = null;\r\n\t}\r\n}\r\n\r\nclass CompositeAnimation {\r\n\tconstructor() {\r\n\t\tthis.handles = new Set();\r\n\t}\r\n\tadd(animation) {\r\n\t\tlet handle = new AnimationHandle(animation);\r\n\t\thandle.remove = () => this.handles.delete(handle);\r\n\t\tthis.handles.add(handle);\r\n\t\treturn handle;\r\n\t}\r\n\tplay(player, time) {\r\n\t\tthis.handles.forEach(handle => handle.play(player, time));\r\n\t}\r\n}\r\n\r\nlet WalkAnimation = (player, time) => {\r\n\tlet skin = player.skin;\r\n\tlet angleRot = time + Math.PI / 2;\r\n\r\n\t// Leg Swing\r\n\tskin.leftLeg.rotation.x = Math.cos(angleRot);\r\n\tskin.rightLeg.rotation.x = Math.cos(angleRot + (Math.PI));\r\n\r\n\t// Arm Swing\r\n\tskin.leftArm.rotation.x = Math.cos(angleRot + (Math.PI));\r\n\tskin.rightArm.rotation.x = Math.cos(angleRot);\r\n};\r\n\r\nexport { CompositeAnimation, WalkAnimation, invokeAnimation };\r\n","import * as THREE from \"three\";\r\nimport { PlayerObject } from \"./model\";\r\nimport { OrbitControls } from \"./orbit_controls\";\r\nimport { invokeAnimation } from \"./animation\";\r\n\r\nfunction copyImage(context, sX, sY, w, h, dX, dY, flipHorizontal) {\r\n\tlet imgData = context.getImageData(sX, sY, w, h);\r\n\tif (flipHorizontal) {\r\n\t\tfor (let y = 0; y < h; y++) {\r\n\t\t\tfor (let x = 0; x < (w / 2); x++) {\r\n\t\t\t\tlet index = (x + y * w) * 4;\r\n\t\t\t\tlet index2 = ((w - x - 1) + y * w) * 4;\r\n\t\t\t\tlet pA1 = imgData.data[index];\r\n\t\t\t\tlet pA2 = imgData.data[index + 1];\r\n\t\t\t\tlet pA3 = imgData.data[index + 2];\r\n\t\t\t\tlet pA4 = imgData.data[index + 3];\r\n\r\n\t\t\t\tlet pB1 = imgData.data[index2];\r\n\t\t\t\tlet pB2 = imgData.data[index2 + 1];\r\n\t\t\t\tlet pB3 = imgData.data[index2 + 2];\r\n\t\t\t\tlet pB4 = imgData.data[index2 + 3];\r\n\r\n\t\t\t\timgData.data[index] = pB1;\r\n\t\t\t\timgData.data[index + 1] = pB2;\r\n\t\t\t\timgData.data[index + 2] = pB3;\r\n\t\t\t\timgData.data[index + 3] = pB4;\r\n\r\n\t\t\t\timgData.data[index2] = pA1;\r\n\t\t\t\timgData.data[index2 + 1] = pA2;\r\n\t\t\t\timgData.data[index2 + 2] = pA3;\r\n\t\t\t\timgData.data[index2 + 3] = pA4;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tcontext.putImageData(imgData, dX, dY);\r\n}\r\n\r\nfunction convertSkinTo1_8(context, width) {\r\n\tlet scale = width / 64.0;\r\n\tlet copySkin = (context, sX, sY, w, h, dX, dY, flipHorizontal) => copyImage(context, sX * scale, sY * scale, w * scale, h * scale, dX * scale, dY * scale, flipHorizontal);\r\n\r\n\tcopySkin(context, 4, 16, 4, 4, 20, 48, true); // Top Leg\r\n\tcopySkin(context, 8, 16, 4, 4, 24, 48, true); // Bottom Leg\r\n\tcopySkin(context, 0, 20, 4, 12, 24, 52, true); // Outer Leg\r\n\tcopySkin(context, 4, 20, 4, 12, 20, 52, true); // Front Leg\r\n\tcopySkin(context, 8, 20, 4, 12, 16, 52, true); // Inner Leg\r\n\tcopySkin(context, 12, 20, 4, 12, 28, 52, true); // Back Leg\r\n\tcopySkin(context, 44, 16, 4, 4, 36, 48, true); // Top Arm\r\n\tcopySkin(context, 48, 16, 4, 4, 40, 48, true); // Bottom Arm\r\n\tcopySkin(context, 40, 20, 4, 12, 40, 52, true); // Outer Arm\r\n\tcopySkin(context, 44, 20, 4, 12, 36, 52, true); // Front Arm\r\n\tcopySkin(context, 48, 20, 4, 12, 32, 52, true); // Inner Arm\r\n\tcopySkin(context, 52, 20, 4, 12, 44, 52, true); // Back Arm\r\n}\r\n\r\nclass SkinViewer {\r\n\tconstructor(options) {\r\n\t\tthis.domElement = options.domElement;\r\n\t\tthis.animation = options.animation || null;\r\n\t\tthis.animationPaused = false;\r\n\t\tthis.animationTime = 0;\r\n\t\tthis.disposed = false;\r\n\r\n\t\t// texture\r\n\t\tthis.skinImg = new Image();\r\n\t\tthis.skinCanvas = document.createElement(\"canvas\");\r\n\t\tthis.skinTexture = new THREE.Texture(this.skinCanvas);\r\n\t\tthis.skinTexture.magFilter = THREE.NearestFilter;\r\n\t\tthis.skinTexture.minFilter = THREE.NearestMipMapNearestFilter;\r\n\r\n\t\tthis.capeImg = new Image();\r\n\t\tthis.capeCanvas = document.createElement(\"canvas\");\r\n\t\tthis.capeTexture = new THREE.Texture(this.capeCanvas);\r\n\t\tthis.capeTexture.magFilter = THREE.NearestFilter;\r\n\t\tthis.capeTexture.minFilter = THREE.NearestMipMapNearestFilter;\r\n\r\n\t\tthis.layer1Material = new THREE.MeshBasicMaterial({ map: this.skinTexture, side: THREE.FrontSide });\r\n\t\tthis.layer2Material = new THREE.MeshBasicMaterial({ map: this.skinTexture, transparent: true, opacity: 1, side: THREE.DoubleSide });\r\n\t\tthis.capeMaterial = new THREE.MeshBasicMaterial({ map: this.capeTexture });\r\n\r\n\t\t// scene\r\n\t\tthis.scene = new THREE.Scene();\r\n\r\n\t\tthis.camera = new THREE.PerspectiveCamera(75);\r\n\t\tthis.camera.position.y = -12;\r\n\t\tthis.camera.position.z = 30;\r\n\r\n\t\tthis.renderer = new THREE.WebGLRenderer({ angleRot: true, alpha: true, antialias: false });\r\n\t\tthis.renderer.setSize(300, 300); // default size\r\n\t\tthis.renderer.context.getShaderInfoLog = () => \"\"; // shut firefox up\r\n\t\tthis.domElement.appendChild(this.renderer.domElement);\r\n\r\n\t\tthis.playerObject = new PlayerObject(options.slim === true, this.layer1Material, this.layer2Material, this.capeMaterial);\r\n\t\tthis.scene.add(this.playerObject);\r\n\r\n\t\t// texture loading\r\n\t\tthis.skinImg.crossOrigin = \"\";\r\n\t\tthis.skinImg.onerror = () => console.error(\"Failed loading \" + this.skinImg.src);\r\n\t\tthis.skinImg.onload = () => {\r\n\t\t\tlet isOldFormat = false;\r\n\t\t\tif (this.skinImg.width !== this.skinImg.height) {\r\n\t\t\t\tif (this.skinImg.width === 2 * this.skinImg.height) {\r\n\t\t\t\t\tisOldFormat = true;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconsole.error(\"Bad skin size\");\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tlet skinContext = this.skinCanvas.getContext(\"2d\");\r\n\t\t\tif (isOldFormat) {\r\n\t\t\t\tlet width = this.skinImg.width;\r\n\t\t\t\tthis.skinCanvas.width = width;\r\n\t\t\t\tthis.skinCanvas.height = width;\r\n\t\t\t\tskinContext.clearRect(0, 0, width, width);\r\n\t\t\t\tskinContext.drawImage(this.skinImg, 0, 0, width, width / 2.0);\r\n\t\t\t\tconvertSkinTo1_8(skinContext, width);\r\n\t\t\t} else {\r\n\t\t\t\tthis.skinCanvas.width = this.skinImg.width;\r\n\t\t\t\tthis.skinCanvas.height = this.skinImg.height;\r\n\t\t\t\tskinContext.clearRect(0, 0, this.skinCanvas.width, this.skinCanvas.height);\r\n\t\t\t\tskinContext.drawImage(this.skinImg, 0, 0, this.skinCanvas.width, this.skinCanvas.height);\r\n\t\t\t}\r\n\r\n\t\t\tthis.skinTexture.needsUpdate = true;\r\n\t\t\tthis.layer1Material.needsUpdate = true;\r\n\t\t\tthis.layer2Material.needsUpdate = true;\r\n\r\n\t\t\tthis.playerObject.skin.visible = true;\r\n\t\t};\r\n\r\n\t\tthis.capeImg.crossOrigin = \"\";\r\n\t\tthis.capeImg.onerror = () => console.error(\"Failed loading \" + this.capeImg.src);\r\n\t\tthis.capeImg.onload = () => {\r\n\t\t\tif (this.capeImg.width !== 2 * this.capeImg.height) {\r\n\t\t\t\tconsole.error(\"Bad cape size\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tthis.capeCanvas.width = this.capeImg.width;\r\n\t\t\tthis.capeCanvas.height = this.capeImg.height;\r\n\t\t\tlet capeContext = this.capeCanvas.getContext(\"2d\");\r\n\t\t\tcapeContext.clearRect(0, 0, this.capeCanvas.width, this.capeCanvas.height);\r\n\t\t\tcapeContext.drawImage(this.capeImg, 0, 0, this.capeCanvas.width, this.capeCanvas.height);\r\n\r\n\t\t\tthis.capeTexture.needsUpdate = true;\r\n\t\t\tthis.capeMaterial.needsUpdate = true;\r\n\r\n\t\t\tthis.playerObject.cape.visible = true;\r\n\t\t};\r\n\r\n\t\tif (options.skinUrl) this.skinUrl = options.skinUrl;\r\n\t\tif (options.capeUrl) this.capeUrl = options.capeUrl;\r\n\t\tif (options.width) this.width = options.width;\r\n\t\tif (options.height) this.height = options.height;\r\n\r\n\t\tlet draw = () => {\r\n\t\t\tif (this.disposed) return;\r\n\t\t\twindow.requestAnimationFrame(draw);\r\n\t\t\tif (!this.animationPaused) {\r\n\t\t\t\tthis.animationTime++;\r\n\t\t\t\tif (this.animation) {\r\n\t\t\t\t\tinvokeAnimation(this.animation, this.playerObject, this.animationTime / 100.0);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.renderer.render(this.scene, this.camera);\r\n\t\t};\r\n\t\tdraw();\r\n\t}\r\n\r\n\tsetSize(width, height) {\r\n\t\tthis.camera.aspect = width / height;\r\n\t\tthis.camera.updateProjectionMatrix();\r\n\t\tthis.renderer.setSize(width, height);\r\n\t}\r\n\r\n\tdispose() {\r\n\t\tthis.disposed = true;\r\n\t\tthis.domElement.removeChild(this.renderer.domElement);\r\n\t\tthis.renderer.dispose();\r\n\t\tthis.skinTexture.dispose();\r\n\t\tthis.capeTexture.dispose();\r\n\t}\r\n\r\n\tget skinUrl() {\r\n\t\treturn this.skinImg.src;\r\n\t}\r\n\r\n\tset skinUrl(url) {\r\n\t\tthis.skinImg.src = url;\r\n\t}\r\n\r\n\tget capeUrl() {\r\n\t\treturn this.capeImg.src;\r\n\t}\r\n\r\n\tset capeUrl(url) {\r\n\t\tthis.capeImg.src = url;\r\n\t}\r\n\r\n\tget width() {\r\n\t\treturn this.renderer.getSize().width;\r\n\t}\r\n\r\n\tset width(newWidth) {\r\n\t\tthis.setSize(newWidth, this.height);\r\n\t}\r\n\r\n\tget height() {\r\n\t\treturn this.renderer.getSize().height;\r\n\t}\r\n\r\n\tset height(newHeight) {\r\n\t\tthis.setSize(this.width, newHeight);\r\n\t}\r\n}\r\n\r\nclass SkinControl {\r\n\tconstructor(skinViewer) {\r\n\t\tthis.enableAnimationControl = true;\r\n\t\tthis.skinViewer = skinViewer;\r\n\r\n\t\tthis.orbitControls = new OrbitControls(skinViewer.camera, skinViewer.renderer.domElement);\r\n\t\tthis.orbitControls.enablePan = false;\r\n\t\tthis.orbitControls.target = new THREE.Vector3(0, -12, 0);\r\n\t\tthis.orbitControls.minDistance = 10;\r\n\t\tthis.orbitControls.maxDistance = 256;\r\n\t\tthis.orbitControls.update();\r\n\r\n\t\tthis.animationPauseListener = e => {\r\n\t\t\tif (this.enableAnimationControl) {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tthis.skinViewer.animationPaused = !this.skinViewer.animationPaused;\r\n\t\t\t}\r\n\t\t};\r\n\t\tthis.skinViewer.domElement.addEventListener(\"contextmenu\", this.animationPauseListener, false);\r\n\t}\r\n\r\n\tdispose() {\r\n\t\tthis.skinViewer.domElement.removeEventListener(\"contextmenu\", this.animationPauseListener, false);\r\n\t\tthis.orbitControls.dispose();\r\n\t}\r\n}\r\n\r\nexport { SkinViewer, SkinControl };\r\n","/**\r\n * @license\r\n * skinview3d <https://github.com/to2mbn/skinview3d>\r\n *\r\n * Copyright (C) 2017 the original author or authors\r\n *\r\n * This program is free software: you can redistribute it and/or modify\r\n * it under the terms of the GNU General Public License as published by\r\n * the Free Software Foundation, either version 3 of the License, or\r\n * (at your option) any later version.\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\r\n *\r\n *\r\n * @author yushijinhun <https://github.com/yushijinhun>\r\n * @author Hacksore <https://github.com/Hacksore>\r\n * @author Kent Rasmussen <https://github.com/earthiverse>\r\n */\r\n\r\nexport { SkinObject, CapeObject, PlayerObject } from \"./model\";\r\nexport { SkinViewer, SkinControl } from \"./viewer\";\r\nexport { CompositeAnimation, WalkAnimation } from \"./animation\";\r\n"],"names":["toFaceVertices","x1","y1","x2","y2","w","h","THREE","toSkinVertices","toCapeVertices","addVertices","box","top","bottom","left","front","right","back","faceVertexUvs","esp","SkinObject","isSlim","layer1Material","layer2Material","head","headBox","headMesh","add","head2Box","head2Mesh","renderOrder","body","bodyBox","bodyMesh","body2Box","body2Mesh","position","y","rightArm","rightArmPivot","rightArmBox","rightArmMesh","rightArm2Box","rightArm2Mesh","x","leftArm","leftArmPivot","leftArmBox","leftArmMesh","leftArm2Box","leftArm2Mesh","rightLeg","rightLegPivot","rightLegBox","rightLegMesh","rightLeg2Box","rightLeg2Mesh","leftLeg","leftLegPivot","leftLegBox","leftLegMesh","leftLeg2Box","leftLeg2Mesh","CapeObject","capeMaterial","capeBox","cape","z","PlayerObject","slim","skin","visible","rotation","Math","PI","OrbitControls","object","domElement","undefined","document","enabled","target","minDistance","maxDistance","Infinity","minZoom","maxZoom","minPolarAngle","maxPolarAngle","minAzimuthAngle","maxAzimuthAngle","enableDamping","dampingFactor","enableZoom","zoomSpeed","enableRotate","rotateSpeed","enablePan","keyPanSpeed","autoRotate","autoRotateSpeed","enableKeys","keys","LEFT","UP","RIGHT","BOTTOM","mouseButtons","ORBIT","ZOOM","MIDDLE","PAN","target0","clone","position0","zoom0","zoom","getPolarAngle","spherical","phi","getAzimuthalAngle","theta","saveState","scope","copy","reset","updateProjectionMatrix","dispatchEvent","changeEvent","update","state","STATE","NONE","offset","quat","setFromUnitVectors","up","quatInverse","inverse","lastPosition","lastQuaternion","sub","applyQuaternion","setFromVector3","rotateLeft","getAutoRotationAngle","sphericalDelta","max","min","makeSafe","radius","scale","panOffset","setFromSpherical","lookAt","set","zoomChanged","distanceToSquared","EPS","dot","quaternion","dispose","removeEventListener","onContextMenu","onMouseDown","onMouseWheel","onTouchStart","onTouchEnd","onTouchMove","onMouseMove","onMouseUp","window","onKeyDown","type","startEvent","endEvent","ROTATE","DOLLY","TOUCH_ROTATE","TOUCH_DOLLY","TOUCH_PAN","rotateStart","rotateEnd","rotateDelta","panStart","panEnd","panDelta","dollyStart","dollyEnd","dollyDelta","getZoomScale","pow","angle","rotateUp","panLeft","v","distance","objectMatrix","setFromMatrixColumn","multiplyScalar","panUp","pan","deltaX","deltaY","element","targetDistance","length","tan","fov","clientHeight","matrix","clientWidth","console","warn","dollyIn","dollyScale","dollyOut","handleMouseDownRotate","event","clientX","clientY","handleMouseDownDolly","handleMouseDownPan","handleMouseMoveRotate","subVectors","handleMouseMoveDolly","handleMouseMovePan","handleMouseWheel","handleKeyDown","keyCode","handleTouchStartRotate","touches","pageX","pageY","handleTouchStartDolly","dx","dy","sqrt","handleTouchStartPan","handleTouchMoveRotate","handleTouchMoveDolly","handleTouchMovePan","button","preventDefault","addEventListener","handleMouseUp","stopPropagation","handleTouchEnd","invokeAnimation","animation","player","time","CompositeAnimation","play","Function","AnimationHandle","paused","_paused","speed","_speed","_lastChange","_lastChangeX","dt","handles","Set","handle","remove","delete","forEach","WalkAnimation","angleRot","cos","copyImage","context","sX","sY","dX","dY","flipHorizontal","imgData","getImageData","index","index2","pA1","data","pA2","pA3","pA4","pB1","pB2","pB3","pB4","putImageData","convertSkinTo1_8","width","copySkin","SkinViewer","options","animationPaused","animationTime","disposed","skinImg","Image","skinCanvas","createElement","skinTexture","magFilter","minFilter","capeImg","capeCanvas","capeTexture","map","side","transparent","opacity","scene","camera","renderer","alpha","antialias","setSize","getShaderInfoLog","appendChild","playerObject","crossOrigin","onerror","error","src","onload","isOldFormat","height","skinContext","getContext","clearRect","drawImage","needsUpdate","capeContext","skinUrl","capeUrl","draw","requestAnimationFrame","render","aspect","removeChild","url","getSize","newWidth","newHeight","SkinControl","skinViewer","enableAnimationControl","orbitControls","animationPauseListener","e"],"mappings":"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"}